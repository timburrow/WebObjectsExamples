<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><META http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Derby Server and Administration Guide</title><META content="text/css" http-equiv="Content-Style-Type"><style type="text/css">
        a { color: black; border: none; text-decoration: none; }
        img { border: none; }
      </style></head><body topmargin="6" leftmargin="6" marginheight="6" marginwidth="6" bgcolor="white"><br><div valign="top"><div style="padding: 6pt; border-width: thin; border-color: black; font-family: Helvetica; margin-top: 2pc;"><div style="text-align: right; margin-bottom: 12pc; margin-top: 12pc; line-height: 100%; font-size: 12pt;"><img src="../images/logowithtext.jpg"></div></div><div style="font-family: Helvetica; text-align: left;"><div style="line-height: 140%; font-weight: bold; font-size: 22pt;">Derby Server and Administration Guide</div><div style="font-style: italic; margin-bottom: 1in; line-height: 140%; font-size: 8pt;">
          Version 10</div></div><div style="line-height: normal; font-size: 8pt; text-align: right; margin-top: 3pc;">
          Derby Document build: <div>December 11, 2006, 7:06:33 AM (PST)</div></div></div><div><div style="line-height: normal; font-size: 8pt; text-align: right; margin-top: 3pc;">
          &copy;  Copyright&nbsp; 
2004, 2006:&nbsp; 
Apache Software Foundation </div></div><br><br><div valign="top"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; text-align: center; color: purple;"></div></div><br><br><div valign="top"><div style="line-height: 8pt; font-size: 8pt;">Copyright</div></div><div valign="top"><a name="page1-1"></a><div style="font-family: Helvetica; font-size: 10pt; line-height: 12pt;"><div style="font-family: Helvetica; text-align: left;"><div> &nbsp;&nbsp;&nbsp; </div><div style="line-height: 140%; font-weight: bold; font-size: 20pt;">
              Contents </div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#radmincopyright"><span style="font-weight: bold;">Copyright</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#cadminpreface30074"><span style="font-weight: bold;">About this guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminpreface11181"><span style="font-weight: bold;">Purpose of this guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminpreface22460"><span style="font-weight: bold;">Audience</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminpreface23947"><span style="font-weight: bold;">How this guide is organized</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#cadminpartone"><span style="font-weight: bold;">Part one: Derby Server Guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminov11108"><span style="font-weight: bold;">Derby in a multi-user environment</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminov17524">Derby in a server framework &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminov38650">About this guide and the Network Server documentation &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminapps59125"><span style="font-weight: bold;">Using the Network Server with preexisting Derby applications</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminappsthenetworkserverandjvms">The Network Server and JVMs &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminappschangingyourclasspath">Installing required jar files and adding them to the classpath &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadmincbdjhhfd">Starting the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigshuttingdownthenetworkserver">Shutting down the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigsysteminformation">Obtaining system information &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminappsclient">Accessing the Network Server by using the network client driver &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminnsdatasources">Accessing the Network Server by using a DataSource &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminapps811478">XA and the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminappsusingthederbytoolswiththene">Using the Derby tools with the Network Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminapps">Differences between running Derby in embedded mode and using the Network
Server &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminappssettingportnumbers">Setting port numbers &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminconfig86869"><span style="font-weight: bold;">Managing the Derby Network Server</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminconfigoverview">Overview &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigsettingnetwrokserverproperties">Setting Network Server properties &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfigverifyingstartup">Verifying Startup &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminservlet98430"><span style="font-weight: bold;">Managing the Derby Network Server remotely by using the servlet interface</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810694">Start-up page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810717">Running page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810796">Trace session page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810822">Trace directory page &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminservlet810910">Set Network Server parameters  &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminadvtops"><span style="font-weight: bold;">Derby Network Server advanced topics</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminnetservsecurity">Network Server security &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminnetservrun">Running the Network Server under the security manager &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminconfiguringthenetworkserver">Configuring the Network Server to handle connections &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminlogfile">Controlling logging by using the log file &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadmintracefacility">Controlling tracing by using the trace facility &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#radminsampleprograms"><span style="font-weight: bold;">Derby Network Server sample programs</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminovnssample">The NsSample sample program &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminovntsrvsample">Network Server sample programs for embedded and client connections &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#cadminparttwo"><span style="font-weight: bold;">Part two: Derby Administration Guide</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminconsist01"><span style="font-weight: bold;">Checking database consistency</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminconsist30301">The SYSCS_CHECK_TABLE function &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminconsist38781">Sample SYSCS_CHECK_TABLE error messages &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminconsist24642">Sample SYSCS_CHECK_TABLE queries &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminhubbkup98797"><span style="font-weight: bold;">Backing up and restoring databases</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminbckupdb">Backing up a database &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminhubbkup44">Restoring a database from a backup copy &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadmincrtdbbkup">Creating a database from a backup copy &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminrollforward">Roll-forward recovery &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminlog98"><span style="font-weight: bold;">Logging on a separate device</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#tadminlog800206">Using the logDevice attribute &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminlog800241">Example of creating a log in a non-default location &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#radminlog800279">Example of moving a log manually &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminlog800315">Issues for logging in a non-default location &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminlockvti42553"><span style="font-weight: bold;">Obtaining locking information</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 9pc;"><a href="#cadminlockvti83889">Monitoring deadlocks &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 7.5pc;"><a href="#cadminspace21579"><span style="font-weight: bold;">Reclaiming unused space</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div><div style="margin-left: 4.9pc; margin-top: 6pt;"><a href="#radmintrademderby"><span style="font-weight: bold;">Trademarks</span> &nbsp;&nbsp;&nbsp; <span>&bull;</span></a></div></div></div></div><div valign="top"><div style="font-family: Helvetica; font-weight: bold; font-size: 10pt; text-align: center;"><span>&bull;</span></div></div><br><br><div valign="top"><div style="line-height: 8pt; font-size: 8pt;">Copyright</div></div><div valign="top"><div style="font-family: Helvetica; font-size: 10pt; text-align: left;">Apache Software FoundationDerby Server and Administration GuideApache Derby<div><a name="N1003D"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="radmincopyright"></a><span></span>Copyright</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10046"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><img src="../images/logowithtext.jpg"></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Copyright 2004, 2006 The Apache Software Foundation or its licensors,
as applicable.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">http://www.apache.org/licenses/LICENSE-2.0</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Unless
required by applicable law or agreed to in writing, software   distributed
under the License is distributed on an "AS IS" BASIS,   WITHOUT WARRANTIES
OR CONDITIONS OF ANY KIND, either express or implied.   See the License for
the specific language governing permissions and   limitations under the License.</div></div></div></div><div><a name="N10073"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="cadminpreface30074"></a><span></span>About this guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes who this guide is for as well as how to use it.</div></div><div><a name="N100C5"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminpreface11181"></a><span></span>Purpose of this guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This guide explains how to use <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a multiple-client environment.
It also provides information that a server administrator might need to keep
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> running with a high level of performance and reliability in a server framework
or in a multiple-client application server environment (When running in embedded mode, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
databases typically do not need any administration).</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To connect multiple clients with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you can embed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a server
framework that you choose, or you can use the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server. This
guide describes these options.</div></div></div><div><a name="N10137"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminpreface22460"></a><span></span>Audience</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The first part of this guide is intended for developers of client/server
and multiple-client applications. The second part of this guide is intended for administrators.</div></div></div><div><a name="N10180"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminpreface23947"></a><span></span>How this guide is organized</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This guide includes the following two parts:</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Part one: <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Server Guide</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminov11108">Derby in a multi-user environment</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes the different options for embedding <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a server framework and
explains the Network Server option.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminapps59125">Using the Network Server with preexisting Derby applications</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to change existing <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> applications to work with the
Network Server.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminconfig86869">Managing the Derby Network Server</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to use shell scripts, the command
line, and the Network Server API to manage the Network Server.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to use the servlet interface to manage the Network Server.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminadvtops">Derby Network Server advanced topics</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes
advanced topics for <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server users.</div></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Part two: <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Administration Guide</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminconsist01">Checking database consistency</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to check the consistency of <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminhubbkup98797">Backing up and restoring databases</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to back up a database when it is online.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminlog98">Logging on a separate device</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to put a database's log on a separate device, which can improve the performance of large databases.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminlockvti42553">Obtaining locking information</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to get detailed information about locking status.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;"><span style="color: blue;"><a href="#cadminspace21579">Reclaiming unused space</a></span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Describes how to identify and reclaim unused space in tables and related indexes.</div></div></td></tr></table></div></div></div></div><div><a name="N102C7"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="cadminpartone"></a><span></span>Part one: Derby Server Guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This part of the guide explains the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server and other server frameworks.
</div></div><div><a name="N10342"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminov11108"></a><span></span>Derby in a multi-user environment</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes how to use <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a multi-user (or "server") environment.</div></div><div><a name="N103D7"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminov17524"></a><span></span>Derby in a server framework</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In a sense, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is
always an embedded product. You can embed it in an application in which users
access the database from a single JVM or you can embed it in a server framework
(an application that allows users from different JVMs to connect to <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> simultaneously).
When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is embedded
in an application, the local JDBC driver calls the local <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database.
When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is embedded
in a server framework, the server framework's connectivity software provides
data to multiple client JDBC applications over a network or the Internet.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For local or remote multi-user connectivity (multiple users who access <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> from different JVMs),
use the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server. If you require features that are not included in the Network Server,
you can embed the basic <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> product
in another server framework.</div></div><div><a name="N1049B"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov825125"></a><span></span>Connectivity configurations</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are several ways to embed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
a server framework:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Use the Network Server</span></div><div style="margin-left: 72pt + 16pt;">This is the easiest way to provide connectivity to multiple users who
are accessing <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases
from different JVMs. The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server provides this kind of connectivity to <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases
within a single system or over a network.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Purchase another server framework</span></div><div style="margin-left: 72pt + 16pt;">You can use <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> within
many server frameworks, such as IBM WebSphere Application Server.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Write your own framework</span></div><div style="margin-left: 72pt + 16pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>'s flexibility
allows other configurations as well. For example, rather than embedding <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in a server that communicates
with a client that uses JDBC, you can embed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> within
a servlet in a web server that communicates with a browser using HTTP.</div></div></div></div></div><div><a name="N10568"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov33597"></a><span></span>Multiple-client features available in Derby</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> contains some features that are useful for developing multi-user applications.</div></div><div><a name="N10616"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov28261"></a><span></span>Row-level locking: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To support multi-user access, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> utilizes
row-level locking. However, you can configure <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> to
use table-level locking in environments that have few concurrent transactions
(for example, a read-only database) . Table-level locking is preferable if
there are few or no writes to the server, while row-level locking is essential
for good performance if many clients write to the server concurrently. The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> optimizer tunes lock
choice for queries automatically.</div></div></div><div><a name="N106A4"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov16172"></a><span></span>Multiple concurrency levels: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> supports SERIALIZABLE
(RR), REPEATABLE (RS), READ COMMITTED (CS), and READ UNCOMMITTED (UR) isolation
levels.</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">CS</span></div><div style="margin-left: 72pt + 16pt;">CS (the default isolation level) provides the best balance between concurrency
and consistency in multiple-client environments.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">RS</span></div><div style="margin-left: 72pt + 16pt;">RS provides less consistency than RR but allows more concurrency.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">RR</span></div><div style="margin-left: 72pt + 16pt;">RR provides greatest consistency.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">UR</span></div><div style="margin-left: 72pt + 16pt;">UR provides maximum concurrency, if uncommitted values are allowed in
the query. It is typically used if approximate results are acceptable.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See "Types and Scope of Locks in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Systems"
in the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information.</div></div></div><div><a name="N10761"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov65220"></a><span></span>Multi-connection and multi-threading: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> allows multiple simultaneous connections to a database, even
in embedded mode. <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is also fully multi-threaded, and you can have
multiple threads active at the same time. However, JDBC semantics impose some
limitations on multi-threading. See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for more information.</div></div></div><div><a name="N107EC"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov83312"></a><span></span>Administrative tools: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides some tools and features to assist database administrators, including:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Consistency checker</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Online backup</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The ability to put a database's log on a separate device</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">These tools and features are discussed in part two of this guide. See the sections in that part for more information.</div></div></div></div><div><a name="N1085F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov825266"></a><span></span>The Derby Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server provides multi-user connectivity to <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> databases
within a single system or over a network. The Network Server uses the standard
Distributed Relational Database Architecture (DRDA) protocol to receive and
reply to queries from clients. Databases are accessed through the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server by using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client driver.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The Network Server is a solution for multiple JVMs that connect to the
database, unlike the embedded scenario where only one JVM runs as part of
the system. When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is
embedded in a single-JVM application, the embedded JDBC driver calls the local <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database. When <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is embedded in a server
framework, the server framework's connectivity software provides data to multiple
client JDBC applications over a network or the Internet.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">To run the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, you need to install the following files:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>On the server side, install <span style="font-family: Courier;">derby.jar</span> and <span style="font-family: Courier;">derbynet.jar</span>.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>On the client side, install <span style="font-family: Courier;">derbyclient.jar</span>.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are several ways to manage the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, including:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Through the command line</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>By using .bat and .ksh scripts</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Through the servlet interface</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>With your own Java program (written using the Network Server API)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>By setting Network Server properties</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminapps59125">Using the Network Server with preexisting Derby applications</a></span> explains how
to change existing Java applications that currently run against <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
embedded mode to run against the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminconfig86869">Managing the Derby Network Server</a></span> explains
how to manage the Network Server by using the command line, including starting
and stopping it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> explains
how to use the servlet interface to manage the Network Server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="color: blue;"><a href="#cadminadvtops">Derby Network Server advanced topics</a></span> contains advanced
topics for <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server users.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Because of the differences in JDBC drivers that are used, you might encounter
differences in functionality when running <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
the Network Server framework as opposed to running it embedded in a user application.
Refer to <span style="color: blue;"><a href="#cadminapps59125">Using the Network Server with preexisting Derby applications</a></span> for a complete
list of the differences between embedded and Network Server configurations.</div></div></div><div><a name="N109A6"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminov825149"></a><span></span>Embedded servers</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Because <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> is written in Java, you have great flexibility in how you choose to configure your deployment. For example, you can run <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, the JDBC server framework, and another application in the same JVM as a single process.</div></div></div><div><a name="N10A22"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminembeddedserver"></a><span></span>How to start an embedded server from an application</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In one thread, the embedding application starts the local JDBC driver for
its own access.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">/*
    If you are running on JDK 1.6 or higher, then you do not
    need to invoke Class.forName(). In that environment, the
    EmbeddedDriver loads automatically.
*/
Class.forName("org.apache.derby.jdbc.EmbeddedDriver").newInstance();
Connection conn = DriverManager.getConnection(
    "jdbc:derby:sample");

</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In another thread, the same application starts the server framework to allow
remote access. Starting the server framework from within the application allows
both the server and the application to run in the same JVM.</div></div></div><div><a name="N10A9D"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminembeddedserverex"></a><span></span>Embedded server example</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10AB7"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can start the Network Server in another thread automatically
when <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> starts by setting
the <span style="font-style: italic;">derby.drda.startNetworkServer</span> property (see <span style="color: blue;"><a href="#tadminconfigsettingnetwrokserverproperties">Setting Network Server properties</a></span>), or you can start it by using a program. The following example shows how to start the Network Server by using a program:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10AD4"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">import org.apache.derby.drda.NetworkServerControl;
import java.net.InetAddress;
NetworkServerControl server = new NetworkServerControl
	(InetAddress.getByName("localhost"),1527);
server.start(null);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10ADE"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The program that starts the Network Server can access the database
by using either the embedded driver or the Network Client driver.
The server framework's attempt to boot the local JDBC driver is ignored because
it has already been booted within the application's JVM. The server framework
simply accesses the instance of <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> that is already booted. There is no conflict between the application and the server framework.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10AED"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The remote client can then connect through the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> client
driver:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10AFC"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String nsURL="jdbc:derby://localhost:1527/sample";  
java.util.Properties props = new java.util.Properties();
props.put("user","usr");
props.put("password","pwd");

/*
    If you are running on JDK 1.6 or higher, then you do not
    need to invoke Class.forName(). In that environment, the
    EmbeddedDriver loads automatically.
*/
Class.forName("org.apache.derby.jdbc.ClientDriver").newInstance();
Connection conn = DriverManager.getConnection(nsURL, props);

/*interact with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>*/
Statement s = conn.createStatement();

ResultSet rs = s.executeQuery(
"SELECT * FROM HotelBookings");</div></pre></div></div></div></div></div><div><a name="N10B6E"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminov38650"></a><span></span>About this guide and the Network Server documentation</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This guide assumes that you are familiar with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> features and tuning. Before reading this guide, you should first learn about basic <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> functionality
by reading the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span>. Also, because multi-user environments typically
have performance and tuning issues, you should read <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Tuning Derby</span></span></span>.</div></div></div></div><div><a name="N10BD2"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminapps59125"></a><span></span>Using the Network Server with preexisting Derby applications</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You must modify Java applications that currently run against <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
embedded mode so that they work with the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server. The topics in this section discuss these changes.</div></div><div><a name="N10CE2"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminappsthenetworkserverandjvms"></a><span></span>The Network Server and JVMs</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server is compatible with <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Java<span style="font-size: 75%;">(TM)</span></span> 2 Platform, Standard Edition, v 1.3.1
(J2SE)</span> and above.</div></div></div><div><a name="N10DA8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminappschangingyourclasspath"></a><span></span>Installing required jar files and adding them to the classpath</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10DCC"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use the Network Server and network client driver, add the
following jar files to your server classpath:</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">derbynet.jar</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This jar file contains the Network Server
code. It is only necessary for the process that starts the Network Server
in addition to the standard <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> .jar
files.</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.jar</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This file must be in your classpath to
use any of the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server functions.</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">derbyclient.jar</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This jar file must be in your class
path to use the Network Client driver. The jar file is necessary for client-side
communication with the Network Server using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client driver. It needs to be in the client-side classpath to use the Network
Client driver to access <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</div></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10E27"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides
script files for setting the classpath to work with the Network Server. The
scripts are located in the $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>\frameworks\NetworkServer\bin
directory.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>setNetworkClientCP.bat (Windows)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>setNetworkClientCP.ksh (UNIX)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>setNetworkServerCP.bat (Windows)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>setNetworkServerCP.ksh (UNIX)</div></td></tr></table></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10E53"></a><span></span>See <span style="color: blue;"><a href="#cadminconfig86869">Managing the Derby Network Server</a></span> and <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Getting Started with Derby</span></span></span> for more information
on setting the classpath.</div></div></div><div><a name="N10F0D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadmincbdjhhfd"></a><span></span>Starting the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10F36"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that you should always properly shut down the Network Server
after use, because failure to do so might result in unpredictable side-effects,
such as blocked ports on the server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the startNetworkServer.bat
script to start the Network Server on Windows machines and the startNetworkServer.ksh
script to start the Network Server on UNIX systems. These scripts are located
in $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/frameworks/NetworkServer/bin,
where $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span> is the
directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You
can run NetworkServerControl commands only from the host that started the
Network Server.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10F5B"></a><span></span>To start the Network Server, you run the appropriate script from
the command line. For example, on a Windows system, if you have installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in the default directory
on the C drive and you have set up your classpath correctly, type the following
command:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>\frameworks\NetworkServer\bin\startNetworkserver.bat</div></pre>The
default system directory is the directory in which <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> was
started. (See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information about the default system directory.)<div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Tip: </span>  You
can set $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>\frameworks\NetworkServer\bin
in your path to shorten the command.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N10F93"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, the Network Server will listen to requests only on
the loopback address, which means that it will only accept connections from
the local host.</div></div></div><div><a name="N11074"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfigalteringthestartnetworkserverscr"></a><span></span>Altering the startNetworkServer script</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1107D"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can modify the startNetworkServer script in any of the following
ways:</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Specify a port number other than the default (1527) by using the <span style="font-family: Courier;">-p &lt;<span style="font-style: italic;">portnumber</span>&gt;</span> option
as shown in the following example:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl start -p 1368</div></pre>where
1368 is the new port number.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Specify a specific interface (host name or IP address) to listen
on other than the default (<span style="font-family: Courier;">localhost</span> by using the <span style="font-family: Courier;">-h</span> option
as shown in the following example: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Remember: </span>  Before
using this option, you should run under the Java security manager and enable
user authentication.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl start -h <span style="font-style: italic;">myhost</span> -p 1368</div></pre>where <span style="font-style: italic;">myhost</span> is the host name or IP address.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">On all interfaces,
you can specify a host name, IP address or 0.0.0.0 to listen.</div></div></div></td></tr></table></div></div></div><div><a name="N11129"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig814934"></a><span></span>Starting the Network Server without using the script</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11148"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you don't want to use the StartNetworkServer script, you can
start the Network Server by using the command line. The syntax for the command
looks like this:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl start
   [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portNumber</span>&gt;]</div></pre></div></div></div><div><a name="N111A7"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig814963"></a><span></span>Starting the Network Server from a Java application</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N111C6"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that you should always properly shut down the Network Server
after use, because failure to do so might result in unpredictable side-effects,
such as blocked ports on the server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are two ways to start the
Network Server from a Java application.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can include the following line in the <span style="font-family: Courier;">derby.properties</span> file: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.startNetworkServer=true</div></pre>This starts
the server on the default port, 1527, listening on <span style="font-family: Courier;">localhost</span> (all
interfaces).</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To specify a different port or a specific
interface in the <span style="font-family: Courier;">derby.properties</span> file, include the following
lines, respectively:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.portNumber=1110
derby.drda.host=<span style="font-style: italic;">myhost</span></div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also specify
the <span style="font-family: Courier;">startNetworkServer</span> and <span style="font-family: Courier;">portNumber</span> properties
by using a Java command: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Dderby.drda.startNetworkServer=true
-Dderby.drda.portNumber=1110
-Dderby.drda.host=<span style="font-style: italic;">myhost yourApp</span></div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the NetworkServerControl API to start the Network Server
from a separate thread within a Java application:  </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl server = new NetworkServerControl();
server.start (null);</div></pre></div></div></td></tr></table></div></div></div><div><a name="N11285"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfigipx"></a><span></span>Starting the Network Server on IPv6/Ipv4 dual stack Windows machines</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N112A4"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following JVM properties need to be added to the command
when starting the server on IPv6/Ipv4 dual stack Windows machines:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">-Djava.net.preferIPv4Stack=false
-Djava.net.preferIPv6Addresses=true</div></pre></div></div></div></div><div><a name="N112F7"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigshuttingdownthenetworkserver"></a><span></span>Shutting down the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">If user authentication is disabled, a <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database
will shut down normally when the Network Server is shut down. If user authentication
is enabled, you must explicitly shut down the database <span style="font-style: italic;">before</span> shutting
down the Network Server by specifying a valid <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> user
name and password.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11337"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The database can be shut down either directly, or by the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> server.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To shut down the Network Server by using the scripts that are provided
for Windows systems, use:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">stopNetworkServer.bat [-h <span style="font-style: italic;">&lt;hostname&gt;</span>] [-p <span style="font-style: italic;">&lt;portnumber&gt;</span>] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To shut down the Network Server by using the scripts that are provided
for UNIX systems, use:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">stopNetworkServer.ksh [-h <span style="font-style: italic;">&lt;hostname&gt;</span>] [-p <span style="font-style: italic;">&lt;portnumber&gt;</span>] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">These scripts are located in the $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/frameworks/NetworkServer/bin
directory.</div></div></td></tr></table></div></div><div><a name="N11451"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815333"></a><span></span>Shutting down by using the command line</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11470"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">From the command line, shut down the Network Server with the
following command: </div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl
	shutdown [-h <span style="font-style: italic;">&lt;hostname&gt;</span>][-p <span style="font-style: italic;">&lt;portnumber&gt;</span>] </div></pre></div></div></div><div><a name="N114B5"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815357"></a><span></span>Shutting down by using the API</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N114D4"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the NetworkServerControl API to shut down the Network
Server from within a Java application. The name of the method that you use
to shutdown the Network Server is <span style="font-family: Courier;">shutdown()</span>.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N114E3"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, the following command shuts down the Network Server
running on the current machine using the default port number (1527):</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl server = new NetworkServerControl();
server.shutdown();</div></pre></div></div></div></div><div><a name="N1151C"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigsysteminformation"></a><span></span>Obtaining system information</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11525"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can obtain information about the Network Server, such as
version and current property values, Java information, and <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database
server information, by using the <span style="font-weight: bold;">sysinfo</span> utility. The <span style="font-weight: bold;">sysinfo</span> utility
is available from scripts, the command line, the NetworkServerControl API,
and through the servlet interface.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following scripts are located
in the $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/frameworks/NetworkServer/bin
directory. Before running these scripts, make sure that the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server is started.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the following <span style="font-weight: bold;">sysinfo</span> script to obtain information about
the Network Server on a Windows system:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">sysinfo.bat [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the following <span style="font-weight: bold;">sysinfo</span> script to obtain information about
the Network Server on a UNIX system:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">sysinfo.ksh [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [&lt;-p <span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr></table></div></div><div><a name="N1165D"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815768"></a><span></span>Obtaining system information by using the command line</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11666"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To run <span style="font-weight: bold;">sysinfo</span> from the command line, use the following
command while the Network Server is running:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl
sysinfo [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Administrative
commands such as <span style="font-family: Courier;">org.apache.derby.drda.NetworkServerControl sysinfo</span> can
only  execute on the host where the server was started, even if the server
was started with the <span style="font-family: Courier;">-h</span> option.</div></div></div></div><div><a name="N116C2"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815853"></a><span></span>Obtaining system information by using the API</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N116EB"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-family: Courier;">sysinfo</span> method produces the same information
as the <span>sysinfo</span> command. The signature for this method is</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String getSysinfo();</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11706"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl serverControl = new NetworkServerControl();
String myinfo = serverControl.getSysinfo();</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-family: Courier;">getSysinfo()</span> method
returns information about the Network Server that is running on the current
machine on the default port number (1527).</div></div></div><div><a name="N11769"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="tadminappsruntimeinfo"></a><span></span>Obtaining Network Server runtime information: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11772"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the <span style="font-weight: bold;">runtimeinfo</span> command or <span style="font-weight: bold;">getRuntimeInfo</span> method
to get memory usage and current session information about the Network Server
including user, database, and prepared statement information.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To run <span style="font-weight: bold;">runtimeinfo</span> from the command line:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl runtimeinfo 
   [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][&lt;-p <span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">The <span style="font-weight: bold;">getRuntimeInfo</span> method returns the same information as
the <span style="font-weight: bold;">runtimeinfo</span> command. The signature for the getRuntimeInfo method
is String getRuntimeInfo(). For example:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl serverControl = new NetworkServerControl();
String <span style="font-style: italic;">myinfo</span> = serverControl.getRuntimeInfo(); </div></pre></div></div></td></tr></table></div></div></div><div><a name="N117FF"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig815822"></a><span></span>Obtaining Network Server properties by using the getCurrent Properties
method: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1181E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The getCurrentProperties method is a Java method that you can
use to obtain information about the Network Server. It returns a Properties
object with the value of all the Network Server properties as they are currently
set.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The signature of this method is:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Properties getCurrentProperties();</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11832"></a><span></span>For example:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl server = new NetworkServerControl();
Properties p = server.getCurrentProperties();
p.list(System.out);
System.out.println(p.getProperty("derby.drda.host"));</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">As shown
in the previous example, you can look up the current properties and then work
with individual properties if needed by using various APIs on the Properties
class. You can also print out all the properties by using the Properties.list()
method.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11842"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> for
information about obtaining system information using the servlet interface.</div></div></div></div></div></div><div><a name="N1187D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminappsclient"></a><span></span>Accessing the Network Server by using the network client driver</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">When connecting to the Network Server, your application needs to
load a driver and connection URL that is specific to the Network Server. In
addition, you must specify a user name and password if you are using authentication.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The driver that you need to access the Network Server is: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">org.apache.derby.jdbc.ClientDriver</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The syntax of the URL that is required to access the Network Server is:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://&lt;<span style="font-style: italic;">server</span>&gt;[:&lt;<span style="font-style: italic;">port</span>&gt;]/
&lt;<span style="font-style: italic;">databaseName</span>&gt;[;&lt;URL attribute&gt;=&lt;value&gt; [;...]]
</div></pre>where the <span style="font-family: Courier;">&lt;URL attribute&gt;</span> is either a <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded or network
client attribute.</div><div><div style="font-weight: bold;"><span style="color: red;">Table 1. </span>Standard JDBC DataSource properties</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Property</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>URL attribute</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Notes</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>databaseName</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The name of the database. This property is required.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>dataSourceName</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The data source name.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>A description of the data source.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>user</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The user's account name.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>user</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default is APP. This property is also available using
EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The user's database password.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>serverName</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The host name or TCP/IP address where the server is
listening for requests.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default is "localhost".</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>portNumber</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Integer</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The port number where the server is listening for requests.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default is "1527".</div></td></tr></tbody></table></div><div><div style="font-weight: bold;"><span style="color: red;">Table 2. </span>Client-specific DataSource properties</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Property</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>URL attribute</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Notes</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceFile</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The filename for tracing output. Setting this property
turns on tracing. See <span style="color: blue;"><a href="#cadminappsclienttracing">Network client tracing</a></span>.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceFile</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceDirectory</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The directory for the tracing output. Each connection
will send output to a separate file. Setting this property turns on tracing.
See <span style="color: blue;"><a href="#cadminappsclienttracing">Network client tracing</a></span>.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceDirectory</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span>&nbsp;'</span></div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceLevel</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Integer</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The level of client tracing if <span style="font-style: italic;">traceFile</span> or <span style="font-style: italic;">traceDirectory</span> are
set.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceLevel</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is TRACE_ALL.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>traceFileAppend</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Boolean</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Value is true if tracing output should append to the
existing trace file.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">traceFileAppend</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is false.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>securityMechanism</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Integer</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The security mechanism. See <span style="color: blue;"><a href="#cadminappsclientsecurity">Network client security</a></span>.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">securityMechanism</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is USER_ONLY _SECURITY.</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>retrieveMessageText</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Boolean</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Retrieve message text from the server. A stored procedure
is called to retrieve the message text with each <span style="font-style: italic;">SQLException</span> and might
start a new unit of work. Set this property to false if you do not want the
performance impact or when starting new units of work.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div><span style="font-style: italic;">retrieveMessageText</span></div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>The default is true.</div></td></tr></tbody></table></div><div><div style="font-weight: bold;"><span style="color: red;">Table 3. </span>Server-Specific DataSource properties</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Property</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Type</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Description</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>URL attributes</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Notes</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>connectionAttributes</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>String</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Set to the list of <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
connection attributes separated by semicolons.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Various</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>This property is also available using EmbeddedDataSource.
See the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span> for more information
about the various connection attributes.</div></td></tr></tbody></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Note that <span style="font-style: italic;">setAttributesAsPassword</span> , which is available for the embedded
DataSource, is not available for the client DataSource.</div></div><div><a name="N11CE0"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsclientsecurity"></a><span></span>Network client security</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client allows you to select a security mechanism by specifying a value for
the <span style="font-family: Courier;">securityMechanism</span> property.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11D0B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You can set the <span style="font-family: Courier;">securityMechanism</span> property in
one of the following ways:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>When you are using the <span style="font-family: Courier;">DriverManager</span> interface, set <span style="font-family: Courier;">securityMechanism</span> in
a <span style="font-family: Courier;">java.util.Properties</span> object before you invoke the form
of the <span style="font-family: Courier;">getConnection</span> method, which includes the <span style="font-family: Courier;">java.util.Properties</span> parameter.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>When you are using the <span style="font-family: Courier;">DataSource</span> interface to create
and deploy your own DataSource objects, invoke the <span style="font-family: Courier;">DataSource.setSecurityMechanism</span> method
after you create a DataSource object.</div></td></tr></table></div><span style="color: blue;"><a href="#radminappsclientsecuritytable">Security mechanisms supported by the Derby Network Client</a></span> lists
the security mechanisms that the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client supports, and the corresponding property value to specify to obtain
this securityMechanism. The default security mechanism is the user id only
if no password is set. If the password is set, the default security mechanism
is both the user id and password. The default user is APP if no other user
is specified.<div><div style="font-weight: bold;"><span style="color: red;">Table 4. </span>Security mechanisms
supported by the Derby Network Client</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Security mechanism</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div><span style="font-family: Courier;">securityMechanism</span> property value</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Comments</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>User id and password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.CLEAR_TEXT_PASSWORD_SECURITY (0x03)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default if password is set</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>User id only</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.USER_ONLY_SECURITY (0x04)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Default if password is not set</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Strong password substitution</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.STRONG_PASSWORD_SUBSTITUTE_SECURITY (0x08)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Strong password substitution cannot be used with external 
Derby authentication schemes (for example, LDAP)</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Encrypted user id and encrypted password</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>ClientDataSource.ENCRYPTED_USER_AND_PASSWORD_SECURITY
(0x09)</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Encryption requires a JCE implementation that supports
the Diffie-Helman algorithm with a prime of 32 bytes.</div></td></tr></tbody></table></div></div></div></div></div><div><a name="N11E41"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsclienttracing"></a><span></span>Network client tracing</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
client provides a tracing facility to collect JDBC trace information and view
protocol flows.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11E66"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">There are various ways to obtain trace output. However, the easiest
way to obtain trace output is to use the <span style="font-family: Courier;">traceFile</span> attribute
on the URL in <span style="font-family: Courier;">ij</span>. The following example shows all tracing
going to the file <span style="font-family: Courier;">trace.out</span> from an <span style="font-family: Courier;">ij</span> session.<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ij&gt;connect 'jdbc:derby://localhost:1527/mydb;
create=true;traceFile=trace.out;user=user1;password=secret4me';</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11E8D"></a><span></span><div style="font-weight: bold;">Implementing ClientDataSource tracing</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You can use
one of three methods to collect tracing data while obtaining connections from
the ClientDataSource:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setLogWriter(java.io.PrintWriter)</span> method of ClientDataSource
and set the <span style="font-family: Courier;">PrintWriter</span> to a non-null value.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setTraceFile(String filename)</span> method of ClientDataSource.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setTraceDirectory(String dirname)</span> method of ClientDataSource
to trace each connection flow in its own file for programs that have multiple
connections.</div></td></tr></table></div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11EC6"></a><span></span><div style="font-weight: bold;">Implementing DriverManager tracing</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Use one of the
following two options to enable and collect tracing information while obtaining
connections using the DriverManager:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">setLogWriter(java.io.PrintWriter)</span> method of DriverManager
and set the <span style="font-family: Courier;">PrintWriter</span> to a non null-value.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">traceFile</span> or <span style="font-family: Courier;">traceDirectory</span> URL
attributes to set these properties prior to creating the connection with the <span style="font-family: Courier;">DriverManager.getConnection()</span> method.</div></td></tr></table></div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N11F00"></a><span></span><div style="font-weight: bold;">Changing the default trace level</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The default trace
level is <span style="font-family: Courier;">ClientDataSource.TRACE_ALL</span>. You can choose the tracing
level by calling the <span style="font-family: Courier;">setTraceLevel(int level)</span> method or by
setting the <span style="font-family: Courier;">traceLevel</span> URL attribute:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String url = "jdbc:derby://samplehost.sampledomain.com:1528/mydb" +
 ";traceFile=/u/user1/trace.out" +
 ";traceLevel=" +
 org.apache.derby.jdbc.ClientDataSource.TRACE_PROTOCOL_FLOWS;
DriverManager.getConnection(url,"user1","secret4me");</div></pre><div><div style="font-weight: bold;"><span style="color: red;">Table 5. </span>Available
tracing levels and values</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Trace level</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Value</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_NONE</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x0</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_CONNECTION_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x1</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_STATEMENT_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x2</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_RESULT_SET_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x4</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE _DRIVER_CONFIGURATION</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x10</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_CONNECTS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x20</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_PROTOCOL_FLOWS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x40</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE _RESULT_SET_META_DATA</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x80</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE _PARAMETER_META_DATA</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x100</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_DIAGNOSTICS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x200</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_XA_CALLS</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0x800</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>org.apache.derby.jdbc.ClientDataSource.TRACE_ALL</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>0xFFFFFFFF;</div></td></tr></tbody></table></div>To specify more than one trace level, use one of the following techniques:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use bitwise OR operators ( | ) with two or more trace values. For example,
to trace PROTOCOL flows and connection calls, specify this value for traceLevel:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">TRACE_PROTOCOL_FLOWS | TRACE_CONNECTION_CALLS</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use a bitwise complement operator ( ~ ) with a trace value to specify
all except a certain trace. For example, to trace everything except PROTOCOL
flows, specify this value for traceLevel:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">~TRACE_PROTOCOL_FLOWS</div></pre></div></td></tr></table></div></div></div></div></div><div><a name="N12078"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminappsclientxmp"></a><span></span>Network client driver examples</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12081"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following examples specify the user and password URL attributes. 
To enable user authentication, the  property <span style="font-style: italic;">derby.connection.requireAuthentication</span>
must be set to true, otherwise, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
does not require a user name and password. For a multi-user product, you would
typically set it for the system in the <span style="font-style: italic;">derby.properties</span> file for your
server, since it is in a trusted environment. Below is a sample
<span style="font-style: italic;">derby.properties</span> file that conforms to these examples:
<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.connection.requireAuthentication=true
derby.authentication.provider=BUILTIN
derby.user.judy=no12see</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N120A8"></a><span></span><div style="font-weight: bold;">Example 1</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example connects to the
default server name localhost on the default port, 1527, and to the database
adminample.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://localhost:1527/sample;user=judy;password=no12see</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N120BC"></a><span></span><div style="font-weight: bold;">Example 2</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following example specifies both <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and Network Client
driver attributes:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://localhost:1527/sample;create=true;user=judy;
password=no12see</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N120D6"></a><span></span><div style="font-weight: bold;">Example 3</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This example connects to the default server
name localhost on the default port, 1527, and includes the path in the database
name portion of the URL.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby://localhost:1527/c:/my-db-dir/my-db-name;user=judy;
password=no12see</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N120EA"></a><span></span><div style="font-weight: bold;">Example 4</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to use
the network client driver to connect the network client to the Network Server:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String databaseURL = "jdbc:derby://localhost:1527/sample";
<span style="font-weight: bold;">//
// Load Derby Network Client driver class
// If you are running on JDK 1.6 or higher, then you do not
// need to invoke Class.forName(). In that environment, the
// network client driver loads automatically.
//</span>
Class.forName("org.apache.derby.jdbc.ClientDriver");
<span style="font-weight: bold;">// Set user and password properties</span>
Properties properties = new Properties();
properties.put("user", "judy");
properties.put("password", "no12see");
<span style="font-weight: bold;">// Get a connection</span>
Connection conn = DriverManager.getConnection(databaseURL, properties); </div></pre></div></div></div><div><a name="N12154"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps810777"></a><span></span>Accessing the Network Server by using the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can use the <span style="border-right-width: 0pt; border-left-width: 0pt;">IBM<span style="font-size: 75%;">(R)</span></span><span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC instead of the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> network
client driver to connect to the Network Server. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You can use the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC instead of the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> network
client driver to connect to the Network Server. Your application needs to
load the driver and connection URL that is specific to the Network Server.
In addition, you specify a user name and password. If you have not set up
authentication, you can use any value for the user name and password. The
driver that you use  to access the Network Server is: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">com.ibm.db2.jcc.DB2Driver</div></pre>You
must have the following two jar files present in your classpath in order to
use the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver
for JDBC:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">db2jcc.jar</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">db2jcc_license_c.jar</span></div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The syntax of the URL that is required to access the Network Server is:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:net://&lt;<span style="font-style: italic;">server</span>&gt;[:&lt;<span style="font-style: italic;">port</span>&gt;]/
&lt;<span style="font-style: italic;">databaseName</span>&gt;[;&lt;<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> URL attribute&gt;=&lt;value&gt; [;...]]
[:&lt;Universal Driver attribute&gt;=&lt;value&gt;; [...;]]</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After you specify the database name and attributes, you can include attributes
for the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver
for JDBC. You must include a semicolon after the last <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC attribute.</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">server</span></div><div style="margin-left: 72pt + 16pt;">The name of the machine where the server is running. It can be the name
of the machine (for example, <span style="font-style: italic;">buffy</span>) or the IP address, for example, <span style="font-style: italic;">158.58.62.225</span>.<div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Unless
the Network Server was started with the <span style="font-family: Courier;">-h</span> option or the <span style="font-style: italic;">derby.drda.host</span> property
set, this value must be <span style="font-family: Courier;">localhost</span>.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">port</span></div><div style="margin-left: 72pt + 16pt;">The port that the server is listening to. The default is 1527.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">database name</span></div><div style="margin-left: 72pt + 16pt;">The name of the database that you are connecting to. The database name
can be a maximum of 18 characters. You must use quotation marks (") to include
path information in the database name. Alternately, you can specify path information
by setting the property <span style="font-style: italic;">derby.system.home</span> in either the <span style="font-family: Courier;"><span style="font-style: italic;">derby.properties</span></span> file
or in the <span style="border-right-width: 0pt; border-left-width: 0pt;">Java<span style="font-size: 75%;">(TM)</span></span> environment when you start the Network Server.
See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information about defining the system home.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span> URL attribute=value</span></div><div style="margin-left: 72pt + 16pt;">Optional database connection URL attributes that are supported by <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>. See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for more information.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-style: italic;">Universal Driver Attribute=value</span></div><div style="margin-left: 72pt + 16pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Optional database connection URL attributes that are supported by the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver
for JDBC.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC requires that you set the user and
password attributes to non-null values.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for
JDBC attributes are available to you when running the Network Server:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">user</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">User name (required by the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC).</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">password</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">User password (required by the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC).</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">portNumber</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The TCP/IP port number where the Network Server listens for connection
requests to this data source. The default is 1527.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">retrieveMessagesFromServerOnGetMessage</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Displays error messages from the server.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">readOnly</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Creates a read-only connection. The default is false.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">logWriter</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A character output stream. All logging and tracing messages print to
the <span style="font-family: Courier;">logWriter</span> property.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">traceLevel</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Specifies the granularity of tracing messages to the <span style="font-family: Courier;">logWriter</span> property.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">traceFile</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Provides an explicit file location for the trace output.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">securityMechanism</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Indicates what type of security mechanism is used.</div></div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">deferPrepares</span></div><div style="margin-left: 72pt + 32pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Controls when prepared statements are physically prepared in the database
server. The default value is true.</div></div></div></div></div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N123D7"></a><span></span><div style="font-weight: bold;"><span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver
for JDBC System information</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server is compatible with the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC release 2.4 and higher.</div></div></div><div><a name="N12454"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="radminapps810699"></a><span></span><span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver
for JDBC examples: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The examples show how to specify the server name, database, and
the URL attributes. You must specify the user name and password attributes
when you use the <span style="border-right-width: 0pt; border-left-width: 0pt;">IBM<span style="font-size: 75%;">(R)</span></span><span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1249E"></a><span></span><div style="font-weight: bold;">Example 1</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example connects to the
default server name <span style="font-style: italic;">localhost</span> on the default port, <span style="font-style: italic;">1527</span>, and
to the database <span style="font-style: italic;">sample</span>. It specifies the URL attributes <span style="font-style: italic;">user, password,</span> and <span style="font-style: italic;">retrieveMessagesFromServerOnGetMessage</span>. </div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:net://localhost:1527/sample:user=judy;password=no12see;
retrieveMessagesFromServerOnGetMessage=true;</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N124D0"></a><span></span><div style="font-weight: bold;">Example 2</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following example specifies the attributes
for both <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver
for JDBC:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:net://localhost:1527/sample;create=true:user=judy;
password=no12see;retrieveMessagesFromServerOnGetMessage=true;</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N124F4"></a><span></span><div style="font-weight: bold;">Example 3</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This example connects to the default server
name <span style="font-style: italic;">localhost</span> on the default port, <span style="font-style: italic;">1527</span>, and includes the path
in the database name portion of the URL. The database name must be delimited
by double quotation marks and you cannot specify <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> attributes
on the URL.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:net://localhost:1527/"c:/my-db-dir/my-db-name":user=judy;
password=no12see;retrieveMessagesFromServerOnGetMessage=true;</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1251A"></a><span></span><div style="font-weight: bold;">Example 4</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following is a sample program fragment
that connects to the Network Server using the <span style="border-right-width: 0pt; border-left-width: 0pt;">DB2<span style="font-size: 75%;">(R)</span></span> Driver for JDBC:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">String databaseURL = "jdbc:derby:net://localhost:1527/sample";
<span style="font-weight: bold;">// Load DB2 Driver for JDBC class</span>
Class.forName("com.ibm.db2.jcc.DB2Driver");
<span style="font-weight: bold;">// Set user and password properties</span>
Properties properties = new Properties();
properties.put("user", "APP");
properties.put("password", "APP");
properties.put("retreiveMessagesFromServerOnGetMessage", "true");
<span style="font-weight: bold;">// Get a connection</span>
Connection conn = DriverManager.getConnection(databaseURL, properties); </div></pre></div></div></div></div></div><div><a name="N12567"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminnsdatasources"></a><span></span>Accessing the Network Server by using a DataSource</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Client driver DataSources
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientDataSource</span> and
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource</span>
are supported by the Network Server. If your client runs on JDK 1.6
or higher, the DataSources are, instead:
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientDataSource40</span> and
<span style="font-family: Courier;">org.apache.derby.jdbc.ClientConnectionPoolDataSource40</span></div></div><div><a name="N12647"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminnsdatasourcexmp"></a><span></span>DataSource access example</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12654"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example uses <span style="font-family: Courier;">org.apache.derby.jdbc.ClientDataSource</span> to
access the Network Server:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12663"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">public static javax.sql.DataSource getDS(String database, String user, String
password) throws SQLException
{
org.apache.derby.jdbc.ClientDataSource ds =
   new org.apache.derby.jdbc.ClientDataSource();

// DatabaseName can include <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> URL Attributes
ds.setDatabaseName(<span style="font-style: italic;">database</span>);

if (user != null)
   ds.setUser(<span style="font-style: italic;">user</span>);
if (password != null)
   ds.setPassword(<span style="font-style: italic;">password</span>);

// The host on which Network Server is running
ds.setServerName("localhost");

// port on which Network Server is listening
ds.setPortNumber(1527);

return ds;
}
</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12685"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The program then can connect: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">javax.sql.DataSource ds = getDS("mydb;create=true", null, null);
// Note:  user and password are required on connection
Connection conn = ds.getConnection("usr2", "pass2");</div></pre></div></div></div></div></div><div><a name="N126B1"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminapps811478"></a><span></span>XA and the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Both the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
driver and the Network Server provide XA support. The Network Server provides
DRDA level 7 support. DRDA clients that support XAMGR, such as the
Derby network client, can send XA requests to
the Network Server. </div></div><div><a name="N1278C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsxawthdriver"></a><span></span>Using XA with the network client driver</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N127AB"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can access XA support for the Network Server by using the
network client driver's XA DataSource interface (<span style="font-family: Courier;">org.apache.derby.jdbc.ClientXADataSource</span>).</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N127BA"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example illustrates how to obtain an XA connection
with the network client driver:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">import org.apache.derby.jdbc.ClientXADataSource;
import javax.sql.XAConnection;
...

XAConnection xaConnection = null;
Connection conn = null;

String driver = "org.apache.derby.jdbc.ClientDataSource";
ClientXADataSource ds = new ClientXADataSource();

ds.setDatabaseName ("sample;create=true");

ds.setServerName("localhost");

ds.setPortNumber(1527);

Class.forName(driver);

xaConnection = ds.getXAConnection("auser", "shhhh");

conn = xaConnection.getConnection();</div></pre></div></div></div></div><div><a name="N127E6"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminappsusingthederbytoolswiththene"></a><span></span>Using the Derby tools with the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> tools <span style="font-family: Courier;">ij</span> and <span style="font-family: Courier;">dblook</span> work in embedded
mode and client/server mode.</div></div><div><a name="N128C8"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminapps811302"></a><span></span>Using the Derby ij tool with the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N128F1"></a><span></span> To use the ij tool with the network client driver:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Startup ij in
one of the following ways:</span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>a.</div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Use a script.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Run the ij.bat script on Windows
systems and the ij.ksh script on UNIX systems. These scripts are located in
the $<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/frameworks/NetworkServer/bin/ directory.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>b.</div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Run the ij tool from the command line.</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.tools.ij </div></pre></div></div></td></tr></table></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Connect by specifying the URL:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ij&gt; CONNECT 'jdbc:derby://localhost:1527/sample'
	USER 'judy' PASSWORD 'no12see';</div></pre>See <span style="color: blue;"><a href="#radminappsclientxmp">Network client driver examples</a></span> for
additional URL examples.</div></div></td></tr></table></div></div></div><div><a name="N12974"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminapps811345"></a><span></span>Using the Derby dblook tool with the Network Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1299D"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use the dblook tool with the Network Client driver, make sure
the Network Server is running (see <span style="color: blue;"><a href="#tadmincbdjhhfd">Starting the Network Server</a></span>),
and then include the necessary <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and
Network Client driver connection attributes as part of the database URL.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N129B4"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.tools.dblook -d 'jdbc:derby://localhost:1527/sample;
user=user1;password=secret4me;'</div></pre></div></div></div></div><div><a name="N129E8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminapps"></a><span></span>Differences between running Derby in embedded mode and using the Network
Server</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes the differences between running <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in embedded mode and
using the Network Server. Note that there may be undocumented differences
that have not yet been identified.</div></div><div><a name="N12AF7"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminappsclientdiffs"></a><span></span>Differences between the embedded client and the network client driver</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The following are known differences that exist between the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
driver and the network client driver. Note that there may be undocumented
differences that have not yet been identified. Some differences with the network
client may be changed in future releases to match the embedded driver functionality.<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Error messages and SQLStates can differ between the network client and
embedded driver. Some SQLStates may be null when using the network client,
particularly for data conversion errors.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Multiple SQL exceptions and warnings will only return the SQLState of
the first exception when using the network client. The text of the additional
exceptions will be appended to the text of the first exception. See <span style="color: blue;"><a href="#radminapps811974">Error message differences</a></span>.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>To use an encrypted user id and password, you need to have the IBM's Java
Cryptography Extension (JCE) Version 1.2.1 or later.</div></td></tr></table></div></div></div></div><div><a name="N12B8D"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminappsresultsetdiffs"></a><span></span>Updatable Result Sets</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The functionality of updatable result sets in a server environment are similar
to an embedded environment in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>,
with the exception of the following differences:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The Network Client requires that there be at least one column in the select
list from the target table. For example, the following statement will fail
in a server environment:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">select 1, 2 from t1 for update of c11</div></pre>The
Network Client driver looks at both of the columns in the select list and
cannot determine the target table for update/delete by looking at the column
metadata. This requirement is not necessary in an embedded environment.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The embedded driver allows for statement name changes when there is an
open result set on the statement object. This is not supported in a server
environment.</div></td></tr></table></div>Other differences between updatable result sets in a server or embedded
environment can be found in the following table.<div><div style="font-weight: bold;"><span style="color: red;">Table 6. </span>Comparison of
updatable result sets features in server and embedded environments</div><table style="margin-top: 12pt; margin-bottom: 10pt; background-color: white; border-style: solid; border-width: 1pt; border-color: black;" valign="top"><thead><tr><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Embedded environment</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; font-weight: bold; text-align: center; padding: 2pt; background-color: silver; margin-left: 2pt;" valign="top"><div>Server environment</div></td></tr></thead><tbody><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>updateBytes on CHAR, VARCHAR, LONG VARCHAR datatypes
supported.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Not supported</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>updateTime on TIMESTAMP datatypes supported.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Not supported</div></td></tr><tr><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>updateClob and updateBlob supported.</div></td><td style="border-style: solid; border-width: 1pt; border-color: black; padding: 2pt; background-color: #faf4fa; margin-left: 2pt;" valign="top"><div>Not supported</div></td></tr></tbody></table></div></div></div></div><div><a name="N12C69"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminapps811974"></a><span></span>Error message differences</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12C92"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The Network Server reports only the first error or warning message
if multiple errors or warnings occur for a given statement. For example: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ij&gt; create table ai (x int, y int generated always as identity
	(increment by 200000000));
ij&gt; insert into ai (x) values (1),(2),(3),(4),(5),(6),(7),
(8),(9),(10),(11),(12),(13),(14),(15),(16),(17),(18),(19);</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12CA1"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The Network Server generates the following error message and appends
the exception message to the error: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR 42Z24: Overflow occurred in identity for column 'Y' in table 'AI':
SQLSTATE: 22003: The resulting value is outside the range 
for the data type INTEGER.</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12CB0"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> embedded
driver, however, would generate two SQL exceptions:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR 42Z24: Overflow occurred in identity for column 'Y' in table 'AI'. 
</div></pre><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR 22003: The resulting value is outside the range for the data type INTEGER.</div></pre></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12CCB"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This is because the network client driver reports only one SQLException
or one SQLWarning per statement.</div></div></div></div><div><a name="N12D25"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps49914"></a><span></span>User authentication differences</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When running <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> in
embedded mode or when using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, you can enable or disable server-side user authentication. However,
when using the Network Server, the default security mechanism (<span style="font-family: Courier;">CLEAR_TEXT_PASSWORD</span>)
requires that you supply both the user name and password.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In addition to the default user name and password security mechanism, <span style="font-style: italic;">org.apache.derby.jdbc.ClientDataSource.CLEAR_TEXT_PASSWORD_SECURITY, </span><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server
supports the following security properties:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;">UserID  (org.apache.derby.jdbc.ClientDataSource.USER_ONLY_SECURITY)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When using this mechanism, you must specify only the user property.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;">Encrypted UserID and encrypted password (org.apache.derby.jdbc.ClientDataSource.ENCRYPTED_USER_AND_PASSWORD_SECURITY)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When using this mechanism, both password and
user id are encrypted.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-style: italic;">Strong password substitution (org.apache.derby.jdbc.ClientDataSource.STRONG_PASSWORD_SUBSTITUTE_SECURITY)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When using this mechanism, a strong password substitute is generated and 
used to authenticate the user with the network server. The original password is 
never sent in any form across the network.</div></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The user's name that is specified upon connection is the default schema
for the connection, if a schema with that name exists. See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information on schema and user names.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you specify any other security mechanism, you will receive an exception.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To change the default, you can specify another security mechanism either
as a property or on the URL (using the securityMechanism attribute) when making
the connection.</div></div><div><a name="N12E60"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps811631"></a><span></span>Network Server user authentication when user authentication is on in Derby: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When user authentication is enabled in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you can either use the default security mechanism (user name and password) or you can specify that the security mechanism be encrypted user and password.</div></div></div><div><a name="N12EAF"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminapps811656"></a><span></span>Network Server user authentication when user authentication is off
in Derby: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When user authentication is turned off in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>, you can use any
of the security mechanism options.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You must provide a user and password for all security mechanisms except <span style="font-style: italic;">USER_ONLY_SECURITY</span>. However, because user authentication
is disabled in the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> server, the user name and password that you supply does not have to be one recognized as valid by <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</div></div></div><div><a name="N12F15"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="tadminapps811695"></a><span></span>Enabling the encrypted user ID and password security mechanism: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N12F4D"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use the encrypted user ID and password security mechanism,
you need IBM JCE (Java Cryptography Extension) 1.2.1 or later. You can use
it with any version of IBM or Sun's <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Java<span style="font-size: 75%;">(TM)</span></span> 2 Platform, Standard Edition, Version
1.2 (J2SE)</span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">IBM Developer Kit for the Java Platform 1.4 or later
comes with IBM JCE, so you do not need to install IBM JCE separately. If you
have an earlier version of IBM Developer Kit for the Java Platform or other
Software Development Kits, complete the following steps:</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Copy the following IBM JCE jar files to the jre/lib/ext directory
of the IBM SDK's installation home:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>ibmjceprovider.jar</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>ibmjcefw.jar</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>ibmpkderby.jar</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>ibmpkcs11.jar</div></td></tr></table></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Modify the java.security file in the jre/lib/security directory.
In the section that lists providers (and preference order), replace the text
with:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">security.provider.1=sun.security.provider.Sun
security.provider.2=com.ibm.crypto.provider.IBMJCE</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  If
you are installing the IBM JCE on a Sun Java Development Kit, you must specify
both of these lines in the order shown.</div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To use the encrypted user id and password security mechanism during
JDBC connection using the network client, specify the <span style="font-family: Courier;">securityMechanism</span> in
the connection property. </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If an encrypted database is booted in
the Network Server, users can connect to the database without giving the <span style="font-family: Courier;">bootPassword</span>.
The first connection to the database must provide the <span style="font-family: Courier;">bootPassword</span>,
but all subsequent connections do not need to supply it. To remove access
from the encrypted database, use the <span style="font-family: Courier;">shutdown=true</span> option
to shut down the database.</div></div></td></tr></table></div></div></div></div><div><a name="N1300C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminappsdiffsreadonly"></a><span></span>Differences using the Connection.setReadOnly method</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In the embedded mode, when the Connection.setReadOnly method has <span style="font-family: Courier;">true</span> as
the parameter, the connection is marked as a read-only connection. When using
a Network Server, the Connection.setReadOnly(true) method is ignored and the
connection is not marked as a read-only connection.</div></div></div></div><div><a name="N13087"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminappssettingportnumbers"></a><span></span>Setting port numbers</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N130B0"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> using
the Network Server listens on TCP/IP port number 1527. If you want to use
a different port number, you can specify it on the command line when starting
the Network Server. For example:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl start -p 1088</div></pre></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">However, it is better to specify the port numbers by using any
of the following methods</span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Change the startNetworkServer.bat or startNetworkServer.ksh scripts </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Use the <span style="font-family: Courier;">derby.drda.portNumber</span> property in <span style="font-family: Courier;">derby.properties</span></div></td></tr></table></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N130EB"></a><span></span>See <span style="color: blue;"><a href="#tadmincbdjhhfd">Starting the Network Server</a></span> for more
information.</div></div></div></div><div><a name="N13197"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminconfig86869"></a><span></span>Managing the Derby Network Server</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server can run as a stand-alone server, with <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> as
an embedded part of the application. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">It can also be managed remotely from a web server by using a servlet interface.
You can manage the Network Server by using shell scripts, the command line,
or the Network Server API. See <span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> for
information about starting and shutting down the Network Server using the
servlet interface.</div></div><div><a name="N1324C"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminconfigoverview"></a><span></span>Overview</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You start the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server using the command line or using the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Server
API. (<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides
scripts for you to use to start the server from the command line.) Before
starting the server, you will probably set certain <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> and
Network Server properties.</div></div><div><a name="N132BF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminconfig813694"></a><span></span>Using the NetworkServerControl API</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N132E3"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You need to create an instance of the NetworkServerControl class
if you are using the API. There are two constructor methods for this class:</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Before
enabling connections from other systems, ensure that you are running under
security manager.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">NetworkServerControl()</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This constructor method
creates an instance that listens either on the default port (1527) or the
port that is set by the <span style="font-family: Courier;">derby.drda.portNumber</span> property. It
will also listen on the host set by the <span style="font-family: Courier;">derby.drda.host</span> property
or the loopback address if the property is not set. This is the default constructor;
it does not allow remote connections. It is equivalent to calling NetworkServerControl(InetAddress.getByName("localhost"),1527)
if no properties are set.</div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">NetworkServerControl (InetAddress address, int portNumber)</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">This constructor method creates an instance that listens on
the specified <span style="font-family: Courier;">portNumber</span> on the specified address. The <span style="font-family: Courier;">InetAddress</span> will
be passed to <span style="font-family: Courier;">ServerSocket</span>. NULL is an invalid address value.
 The following examples show how you might allow Network Server to accept
connections from other hosts: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">//accepts connections from other hosts on an IPv4 system
NetworkServerControl serverControl = 
  new NetworkServerControl(InetAddress.getByName("0.0.0.0"),1527);</div></pre><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">//accepts connections from other hosts on an IPV6 system
NetworkServerControl serverControl = 
  new NetworkServerControl(InetAddress.getByName("::"),1527);</div></pre></div></div></div></td></tr></table></div></div></div></div><div><a name="N13360"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigsettingnetwrokserverproperties"></a><span></span>Setting Network Server properties</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13389"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You can specify Network Server properties in three ways: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>On the command line</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>In the <span style="font-family: Courier;">.bat</span> or <span style="font-family: Courier;">.ksh</span> files (loading the
properties by executing <span style="font-family: Courier;">java -D</span>)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>In the <span style="font-family: Courier;">derby.properties</span> file. </div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Properties in the command line or in the <span style="font-family: Courier;">.bat </span>or <span style="font-family: Courier;">.ksh</span> files
take precedence over the properties in the <span style="font-family: Courier;">derby.properties</span> file.
Arguments included on commands that are issued on the command line take precedence
over property values.</div></div></div><div><a name="N134AC"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdahost"></a><span></span>derby.drda.host</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N134C6"></a><span></span>Causes the Network Server to listen on a specific network interface.
This property allows multiple instances of Network Server to run on a single machine,
each using its own unique host:port combination. The host needs to be set
to enable remote connections. By default, the Network Server will listen only
on the loopback address. If the property is set to 0.0.0.0, Network Server
will listen on all interfaces. Ensure that you are running under the security
manager and that user authorization is enabled before you enable remote
connections with this property. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N134CB"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.host=<span style="font-style: italic;">hostname</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N134DF"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If no host name is specified, the Network Server
listens on the loopback address of the current machine (localhost).</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N134ED"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.host=myhost</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13500"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the
Network Server for changes to take effect.</div></div></div></div><div><a name="N135BA"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdakeepalive"></a><span></span>derby.drda.keepAlive</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N135D4"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Indicates whether SO_KEEPALIVE is enabled on sockets. The keepAlive
mechanism is used to detect when clients disconnect unexpectedly.  A <span style="font-style: italic;">keepalive
probe</span> is sent to the client if a long time (by default, more than two
hours) passes with no other data being sent or received.
The <span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span>.drda.keepAlive property is used to detect and clean up connections for
clients on powered-off machines or clients that have disconnected unexpectedly.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N135E9"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the property is set to false, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> will
not attempt to clean up disconnected clients. The keepAlive mechanism might
be disabled if clients need to resume work without reconnecting even after
being disconnected from the network for some time. To disable keepAlive probes
on Network Server connections, set this property to false.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N135F8"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.keepAlive=[true|false] </div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13607"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">True.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13615"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drdra.keepAlive=false </div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13624"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N136DE"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigdb2jdrdalogconnections"></a><span></span>derby.drda.logConnections</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N136F8"></a><span></span>Indicates whether to log connections. Also controls the logging of
the connection number. Connection number tracing, if enabled, goes to both
the <span style="font-family: Courier;">derby.log</span> file and the network server console.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13703"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.logConnections=[true|false]</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13712"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">False.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13720"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.logConnections=true </span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13733"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server
has been started.</div></div></div></div><div><a name="N137ED"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdamaxthreads"></a><span></span>derby.drda.maxThreads </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13807"></a><span></span>Use the derby.drda.maxThreads property to set a maximum number of
connection threads that Network Server will allocate. If all of the connection
threads are currently being used and the Network Server has already allocated
the maximum number of threads, the threads will be shared by using the derby.drda.timeSlice
property to determine when sessions will be swapped.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1380C"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.maxThreads=<span style="font-style: italic;">numthreads</span></span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13824"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13832"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.maxThreads=50</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13845"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N138FF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdaminthreads"></a><span></span>derby.drda.minThreads </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13919"></a><span></span>Use the derby.drda.minThreads property to set the minimum number
of connection threads that Network Server will allocate. By default, connection
threads are allocated as needed.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1391E"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.minThreads=<span style="font-style: italic;">numthreads</span></span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13936"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13944"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.minThreads=10</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13957"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the
Network Server for changes to take effect.</div></div></div></div><div><a name="N13A11"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigportnumber"></a><span></span>derby.drda.portNumber</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13A2B"></a><span></span>Indicates the port number to use. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13A30"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.portNumber=<span style="font-style: italic;">portnumber</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13A44"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If no port number is specified, 1527 is
the default.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13A52"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.portNumber=1110</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13A65"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N13B1F"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdasecmechanism"></a><span></span>derby.drda.securityMechanism</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B43"></a><span></span>The derby.drda.securityMechanism property restricts the client connections
based on the security mechanism. <div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the derby.drda.securityMechanism property
is set to a valid mechanism, the Network Server accepts only connections which
use that security mechanism. No other types of connections are accepted. 
If the derby.drda.securityMechanism property is not set, the Network Server
accepts any connection which uses a valid security mechanism.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B4D"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.securityMechanism = [ 
    USER_ONLY_SECURITY | 
    CLEAR_TEXT_PASSWORD_SECURITY | 
    ENCRYPTED_USER_AND_PASSWORD_SECURITY | 
    STRONG_PASSWORD_SUBSTITUTE_SECURITY 
] </span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B60"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">None. </div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B6E"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.securityMechanism=USER_ONLY_SECURITY
</span></div></pre> The server that runs with this setting accepts only client
connections with the USER_ONLY_SECURITY value. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13B82"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for the changes that are associated with this property to take effect.</div></div></div></div><div><a name="N13C3C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigstartnetworkserver"></a><span></span>derby.drda.startNetworkServer</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C56"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the derby.drda.startNetworkServer property to simplify
embedding the Network Server in your Java application. When you set 
derby.drda.startNetworkServer to true, the Network Server will automatically 
start when you start <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> 
(in this context, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>
will start when the embedded driver is loaded). Only one Network Server
can be started in a JVM.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">NOTE:
If you start the Network Server with this property set to true, the Network 
Server will stop when your application ends or when you stop it by other means 
(e.g. by using the Java API, the command line interface, or by shutting down 
the Derby system), whichever comes first.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C70"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.startNetworkServer=[true | false]</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C7F"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">False.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13C8D"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.startNetworkServer=true</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13CA0"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must shut down the
Network Server and restart <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> for
this change to take effect.</div></div></div></div><div><a name="N13D60"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdaStreamOutBufferSize"></a><span></span>derby.drda.streamOutBufferSize</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D7A"></a><span></span>
Configure size of buffer for streaming blob/clob from server to client. 
If the configured size is 0 or less, the buffer is not placed.

<div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  <div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This configuration is used when optimizing streaming blob/clob from server to client.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If there were found many small packets, of which sizes are much lower than maximum size of packet possible in the network,
it will improve performance of streaming to setting this configuration.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Recommended value of this configuration is maximum packet size possible in the network minus appropriate size for header.</div></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13D92"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.streamOutBufferSize=<span style="font-style: italic;">size of buffer</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13DA6"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13DB4"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.streamOutBufferSize=1024</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13DC7"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server has
been started.</div></div></div></div><div><a name="N13E81"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radmindrdatimeslice"></a><span></span>derby.drda.timeSlice </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13E9B"></a><span></span>Use the derby.drda.timeSlice property to set the number of milliseconds
that each connection will use before yielding to another connection. This
property is relevant only if the derby.drda.maxThreads property is set
to a value greater than zero.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13EA0"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">derby.drda.timeSlice=<span style="font-style: italic;">milliseconds</span></span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13EB8"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">0</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13EC6"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.timeSlice=2000</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13ED9"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Static. You must restart the Network
Server for changes to take effect.</div></div></div></div><div><a name="N13F93"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfig"></a><span></span>derby.drda.traceAll</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FAD"></a><span></span>Turns tracing on for all sessions.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FB2"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceAll=[true|false]</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FC1"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">False.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FCF"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.traceAll=true</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N13FE2"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server has
been started.</div></div></div></div><div><a name="N1409C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="radminconfigdb2jdrdatracedirectory"></a><span></span>derby.drda.traceDirectory</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140B6"></a><span></span>Indicates the location of tracing files. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140BB"></a><span></span><div style="font-weight: bold;">Syntax</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceDirectory=<span style="font-style: italic;">tracefiledirectory</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140CF"></a><span></span><div style="font-weight: bold;">Default</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the derby.system.home property
has been set, it is the default. Otherwise, the default is the current directory.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140DD"></a><span></span><div style="font-weight: bold;">Example</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">derby.drda.traceDirectory=c:/<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>/trace</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N140F6"></a><span></span><div style="font-weight: bold;">Static or dynamic</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Dynamic. System values can be
changed by using commands or the servlet interface after the Network Server has
been started.</div></div></div></div></div><div><a name="N141B0"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfigverifyingstartup"></a><span></span>Verifying Startup</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To verify that the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server is currently running, use the ping command.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N141DA"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the ping command in the following ways:</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the scripts NetworkServerControl.bat for Windows systems
or NetworkServerControl.ksh for UNIX systems with the <span style="font-weight: bold;">ping</span> command.
For example:  </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">NetworkServerControl ping [-h &lt;<span style="font-style: italic;">hostname</span>&gt;;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;]</div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the NetworkServerControl command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl
   ping [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can use the NetworkServerControl API to verify startup from
within a Java application: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ping(); </div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1423E"></a><span></span>The following example uses a method to verify startup. It will try
to verify for the specified number of seconds: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">private static boolean isServerStarted(NetworkServerControl server, int ntries)
	{
		for (int i = 1; i &lt;= ntries; i ++)
		{
			try {
				Thread.sleep(500);
				server.ping();
				return true;
			}
			catch (Exception e) {
				if (i == ntries)
					return false;
			}
		}
		return false;
	}</div></pre></div></div></div></div><div><a name="N14280"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminservlet98430"></a><span></span>Managing the Derby Network Server remotely by using the servlet interface</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can use the servlet interface to manage the Network Server
remotely. To use the servlet interface, the servlet must be registered with
an Application Server, and derby.system.home must be known to the Application Server.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A Web application archive (WAR) file, <span style="font-style: italic;">derby.war</span>, for the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> 
Network Server is available in <span style="font-style: italic;">$<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>/lib.</span> This
file registers the Network Server's servlet at the relative path <span style="font-style: italic;">/derbynet</span>.
See the documentation for your Application Server for instructions on how
to install it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, if <span style="font-style: italic;">derby.war</span> is installed in WebSphere Application
Server with a context root of <span style="font-family: Courier;">derby</span>, the URL of the server
is:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">http://&lt;server&gt;[:port]/derby/derbynet</div></pre><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Notes: </span>  <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>A servlet engine is not part of the Network Server.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>When the Network Server is started by the servlet interface, shutting down
the Application Server also shuts the Network Server down, since both run in the
same JVM.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The servlet takes the following optional configuration parameters:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">portNumber</span></div><div style="margin-left: 72pt + 16pt;">Specifies the port number to be used by the Network Server.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">startNetworkServerOnInit</span></div><div style="margin-left: 72pt + 16pt;">Specifies that the Network Server is to be started when the servlet is
initialized.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">tracingDirectory</span></div><div style="margin-left: 72pt + 16pt;">Specifies the location for trace files. If the tracing directory is not
specified, the traces are placed in <span style="font-style: italic;">derby.system.home</span>.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes the servlet pages.</div></div><div><a name="N143BE"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810694"></a><span></span>Start-up page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">Use the start-up page to start the server.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N143E2"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In addition to starting the Network Server, you can use the startup
page to perform the following actions:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Turn logging on when the server is started. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Turn tracing on for all sessions when the server is started. </div></td></tr></table></div></div></div></div><div><a name="N1444A"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810717"></a><span></span>Running page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14469"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the Network Server is running (whether it was started by initializing
the servlet or in some other manner), the running page is displayed. The running
page indicates whether logging is on or off, whether tracing is on or off,
and if tracing is on, indicates for which session.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14472"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can use the running page to stop the server and turn logging and tracing
on or off. The following options are available
from the running page:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1447B"></a><span></span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Start or stop logging. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Start or stop tracing all sessions. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify session to trace. (If you choose this option, the Trace session
page is displayed.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Change tracing directory (If you choose this option, the Trace directory
page is displayed.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify threading parameters for Network Server. (If you choose this option,
the Thread parameters page is displayed.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Stop the Network Server.</div></td></tr></table></div></div></div></div><div><a name="N144F2"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810796"></a><span></span>Trace session page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N144FF"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If on the running page you choose to specify a session to trace, this page
is displayed. You must enter the Session ID. </div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14508"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You are given the option to turn tracing on or off or return to the previous
menu. When you push the Trace On/Off button, information indicating the current
tracing state is displayed.</div></div></div></div><div><a name="N14562"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810822"></a><span></span>Trace directory page</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1456F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This page is displayed if the you choose to change the tracing directory
on the Running page. You must enter the Trace Directory. </div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14578"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can either set a tracing directory, or you can return to the previous
menu. Additional information is displayed that indicates the current tracing
directory when you push the Set Directory button. </div></div></div></div><div><a name="N145D2"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminservlet810910"></a><span></span>Set Network Server parameters </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N145DF"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The first page is displayed if the thread parameter button is
pressed. Use this page to set the new parameters. Enter the following information:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N145E8"></a><span></span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>New maximum number of threads</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>New thread time slice</div></td></tr></table></div>If either the maximum threads or time slice parameters are left blank,
that value is left unchanged from the current setting. </div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N145FB"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Click Set Network Server parameters to display the updated values
for the maximum threads and the time slice parameters.</div></div></div></div></div><div><a name="N14655"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminadvtops"></a><span></span>Derby Network Server advanced topics</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section discusses several advanced topics for users of the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server.</div></div><div><a name="N14711"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminnetservsecurity"></a><span></span>Network Server security</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server will only listen on the localhost. Clients must use the localhost host
name to connect. By default, clients cannot access the Network Server from
another host. To enable connections from other hosts, set the derby.drda.host
property, or start the Network Server with the <span style="font-family: Courier;"><span style="font-style: italic;">-h</span></span> option
in the <span style="font-family: Courier;"><span style="font-style: italic;">java org.apache.derby.drda.NetworkServerControl start</span></span> command.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In the following example the server will listen only on localhost and clients
cannot access the server from another host.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl start</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In the following example, the server runs on host machine <span style="font-family: Courier;"><span style="font-style: italic;">sampleserver.sampledomain.com</span></span> and
also listens for clients from other hosts. Clients must specify the server
in the URL or DataSource as sampleserver.sampledomain.com:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl start 
   -h sampleserver.sampledomain.com</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">To start the Network Server so that it will listen on all interfaces, start
with an IP address of <span style="font-family: Courier;"><span style="font-style: italic;">0.0.0.0</span></span>, shown in the following
example:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">java org.apache.derby.drda.NetworkServerControl start -h 0.0.0.0</span></div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">A server that is started with the <span style="font-family: Courier;"><span style="font-style: italic;">-h 0.0.0.0</span></span> option
will listen to client requests that originate from both <span style="font-family: Courier;"><span style="font-style: italic;">localhost</span></span> and
from other machines on the network.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">However, administrative commands (for example, <span style="font-family: Courier;"><span style="font-style: italic;">org.apache.derby.drda.NetworkServerControl
shutdown</span></span>) can run only on the host where the server was started,
even if the server was started with the <span style="font-family: Courier;"><span style="font-style: italic;">-h</span></span> option.</div></div></div><div><a name="N14818"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminnetservrun"></a><span></span>Running the Network Server under the security manager</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14837"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You should run the Network Server under the Java security manager.
An sample security policy file is shown in the following examples. Fine tune
this policy to suit your needs.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">CAUTION: </span>  Opening
up the server to all clients without limiting access by using a policy similar
to the one in the following example is a severe security risk.</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">//Recommended set of permissions to start and use the Network Server,
//assuming the 'd:/<span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span>/lib' directory has been secured. 
//Fine tune based on your environment settings
grant codeBase "file:d:/<span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span>/lib/-" {
permission java.io.FilePermission "${derby.system.home}${/}-", 
	"read, write, delete";
permission java.io.FilePermission "${derby.system.home}","read";
permission java.io.FilePermission "${user.dir}${/}-", "read, write, delete";
permission java.util.PropertyPermission "derby.*", "read";
permission java.util.PropertyPermission "user.dir", "read";
permission java.lang.RuntimePermission "createClassLoader";
permission java.net.SocketPermission "myclientmachine", "accept";
};
 
//Required set of permissions to stop the Network Server, assuming you have
// secured the 'd:/<span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span>/lib' directory
//Remember to fine tune this as per your environment.
grant codeBase "file:d:/<span style="border-right-width: 0pt; border-left-width: 0pt;">derby</span>/lib/-"  {
//Following is required when server is started with "-h localhost" 
//or without the -h option
permission java.net.SocketPermission "localhost", "accept, connect, resolve"; 
permission java.net.SocketPermission "127.0.0.1", "accept, connect, resolve";
//The following is only required if the server is started with the -h &lt;host&gt; 
//option (else shutdown access will be denied).
permission java.net.SocketPermission "&lt;host&gt;:*", "accept, connect, resolve";
};</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14865"></a><span></span><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The following example shows how to start the Network Server in the default
security manager (listening to clients from <span style="font-family: Courier;">localhost</span> only,
which is the default behavior if the <span style="font-family: Courier;">-h</span> option is not used
to start the server). This example assumes that the policy file exists in <span style="font-family: Courier;">d:/nwsvr.policy</span>.<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Djava.security.manager -Djava.security.policy=d:/nwsvr.policy
org.apache.derby.drda.NetworkServerControl start </div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>You can also achieve the same behavior by using the <span style="font-family: Courier;">-h</span> option
when starting the server as shown in the following example:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Djava.security.manager -Djava.security.policy=d:/nwsvr.policy
org.apache.derby.drda.NetworkServerControl start -h localhost</div></pre></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The following example shows how to start the Network Server (assuming
that you start the server on the host machine <span style="font-style: italic;">myserver</span>) in the default
security manager  (listening to client requests originating from other machines
only). This example assumes that the policy file exists in <span style="font-family: Courier;">d:/nwsvr.policy</span>.<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java -Djava.security.manager -Djava.security.policy=d:/nwsvr.policy
org.apache.derby.drda.NetworkServerControl start -h <span style="font-style: italic;">myserver</span></div></pre></div></td></tr></table></div></div></div></div><div><a name="N14908"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminconfiguringthenetworkserver"></a><span></span>Configuring the Network Server to handle connections</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14922"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can configure the Network Server to use a specific number
of threads to handle connections. You can change the configuration on the
command line or by using the servlet interface.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The minimum number
of threads is the number of threads that are started when the Network Server
is booted. This value is specified as a property, <span style="font-family: Courier;">derby.drda.minThreads
= &lt;<span style="font-style: italic;">min</span>&gt;</span>. The maximum number of threads is the maximum
number of threads that will be used for connections. If more connections are
active than there are threads available, the extra connections must wait until the next
thread becomes available. Threads can become available after a specified time,
which is checked only when a thread has finished processing a communication.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">You can change the maximum number of threads by using the following
command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl maxthreads &lt;<span style="font-style: italic;">max</span>&gt; [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] 
[-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also use
the <span style="font-family: Courier;">derby.drda.maxThreads</span> property to assign the maximum
value. A &lt;<span style="font-style: italic;">max</span>&gt; value of 0 means that there is no maximum and
a new thread will be generated for a connection if there are no current threads
available. This is the default. The &lt;<span style="font-style: italic;">max</span>&gt; and &lt;<span style="font-style: italic;">min</span>&gt;
values are stored as integers, so the theoretical maximum is 2147483647 (the
maximum size of an integer). But the practical maximum is determined by the
machine configuration. </div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To change the time that a thread should work on one session's request
and check if there are waiting sessions, use the following command: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl 
timeslice &lt;<span style="font-style: italic;">milliseconds</span>&gt; [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can also use the derby.drda.timeSlice property
to set this value. A value of 0 milliseconds indicates that the thread will
not give up working on the session until the session ends. A value of -1 milliseconds
indicates to use the default. The default value is 0. The maximum number of
milliseconds that can be specified is 2147483647 (the maximum size of an integer).</div></div></div></td></tr></table></div></div></div><div><a name="N14A01"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminlogfile"></a><span></span>Controlling logging by using the log file</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14A2A"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The Network Server uses the <span style="font-family: Courier;">derby.log</span> file to
log problems that it encounters. It also logs connections when the property <span style="font-family: Courier;">derby.drda.logConnections</span> is
set to <span style="font-family: Courier;">true</span>. The <span style="font-family: Courier;">derby.log</span> file is created
when the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> server
is started. The Network Server then records the time and version. If a log
file exists, it is overwritten, unless the property <span style="font-family: Courier;">derby.infolog.append</span> is
set to <span style="font-family: Courier;">true</span>. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> When the Network Server is logging connections,
it also logs the Connection Number; this log message is written both to the <span style="font-family: Courier;">derby.log</span> file
and to the Network Server console.</div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To turn on connection logging, you can use the servlet interface
or you can issue the following command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl 
   logconnections on [-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">To turn connection logging off you can use the servlet interface
or you can issue the following command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl 
   logconnections off [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14AAA"></a><span></span>See the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span> for
more information about the <span style="font-family: Courier;">derby.log</span> file.</div></div></div><div><a name="N14B14"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadmintracefacility"></a><span></span>Controlling tracing by using the trace facility</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14B3D"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use the trace facility only if you are working with technical
support and they require tracing information.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14B46"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminservlet98430">Managing the Derby Network Server remotely by using the servlet interface</a></span> for
information about managing the trace facility using the servlet interface. </div></div></div><div><a name="N14BC6"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminadv804410"></a><span></span>Turning on the trace facility</div><div style="margin-left: 72pt; font-size: 10pt;"><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Turn on tracing for all sessions by specifying the following property:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceAll=true </div></pre>Alternatively, while
the Network Server is running, you can use the following command to turn on
the trace facility:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl
   trace on [-s &lt;<span style="font-style: italic;">connection number</span>&gt;] [-h &lt;<span style="font-style: italic;">hostname</span>&gt;][-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you specify a &lt;<span style="font-style: italic;">connection number</span>&gt;, tracing will be turned
on only for that connection.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the location of the tracing files by specifying the following
property:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">derby.drda.traceDirectory=&lt;<span style="font-style: italic;">directory for tracing files</span>&gt;</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You need to specify only the directory where the tracing files will
reside. The names of the tracing files are determined by the system. If you
do not set a trace directory, the tracing files will be placed in derby.system.home.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">While the Network Server is running, enter the following command
to set the trace directory:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl traceDirectory 
&lt;<span style="font-style: italic;">directory for tracing files</span>&gt;[-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;]  </div></pre></div></div></td></tr></table></div></div></div><div><a name="N14C6A"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminadv804451"></a><span></span>Turning off the trace facility</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14C73"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Enter the following command to turn off tracing:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.drda.NetworkServerControl trace off [-s &lt;<span style="font-style: italic;">connection number</span>&gt;] 
[-h &lt;<span style="font-style: italic;">hostname</span>&gt;] [-p &lt;<span style="font-style: italic;">portnumber</span>&gt;] </div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The
tracing files are named ServerX.trace, where X is a connection number.</div></div></div></div></div></div><div><a name="N14CB6"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="radminsampleprograms"></a><span></span>Derby Network Server sample programs</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14CD0"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section describes several <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server sample
programs for Network Server users.</div></div></div><div><a name="N14D5C"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminovnssample"></a><span></span>The NsSample sample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The <span style="font-style: italic;">NsSample</span> demonstration program is a simple JDBC application
that interacts with the Network Server.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14D86"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The <span style="font-style: italic;">NsSample</span> program performs the following tasks: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Starts the Network Server. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Checks that the Network Server is running.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Loads the Network Client driver. (Note that this step is not
necessary if you are running the client on JDK 1.6 or higher. In that
environment, the network client driver loads automatically.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Creates the <span style="font-style: italic;">NsSampledb</span> database if not already created. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Checks to see if the schema is already created, and if not, creates the
schema which includes the SAMPLETBL table and corresponding indexes. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Connects to the database.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Loads the schema by inserting data. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Starts client threads to perform database related operations. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Has each of the clients perform DML operations (select, insert, delete,
update) using JDBC calls. For example, one client thread establishes an embedded
connection to perform database operations, while another client thread establishes
a client connection to the Network Server to perform database operations. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Waits for the client threads to finish the tasks. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Shuts down the Network Server at the end of the demonstration.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You must install the following files in the <span style="font-family: Courier;">%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo\</span> directory before you can run the sample program: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSample.java</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This is the entry point into the
sample program. The program starts up two client threads. The first client
establishes an embedded connection to perform database operations, and the
second client establishes a client connection to the Network Server to perform
database operations.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can change the following constants to modify
the sample program:</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NUM_ROWS</span></div><div style="margin-left: 72pt + 32pt;">The number of rows that must be initially loaded into the schema.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">ITERATIONS</span></div><div style="margin-left: 72pt + 32pt;">The number of iterations for which each client thread does database related
work.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NUM_CLIENT_THREADS</span></div><div style="margin-left: 72pt + 32pt;">The number of clients that you want to run the program against.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NETWORKSERVER_PORT</span></div><div style="margin-left: 72pt + 32pt;">The port on which the Network Server is running.</div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSampleClientThread.java</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">This file contains two
Java classes:  <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The NsSampleClientThread class extends Thread and instantiates a NsSampleWork
instance. </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The NsSampleWork class contains everything that is required to perform
DML operations using JDBC calls. The <span style="font-style: italic;">doWork</span> method in the NsSampleWork
class represents all the work done as part of this sample program. </div></td></tr></table></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NetworkServerUtil.java</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This file contains helper
methods to start the Network Server and to shutdown the server.</div></div></td></tr></table></div>The compiled class files for the NsSample program are:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSample.class</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSampleClientThread.class</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NsSampleWork.class</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="font-family: Courier;">NetworkServerUtil.class</span></div></td></tr></table></div></div></div></div><div><a name="N14ECF"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminovnsrundemo"></a><span></span>Running the NsSample sample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14ED8"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To run the NsSample program:  </div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Open a command prompt and change directories to the %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\
directory, where %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%
is the directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the CLASSPATH to the current directory (".") and also include
the following jar files in order to use the Network Server and the network
client driver:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbynet.jar</span></div><div style="margin-left: 72pt + 32pt;">The Network Server jar file. It must be in your CLASSPATH to use any of
the Network Server functions.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbyclient.jar</span></div><div style="margin-left: 72pt + 32pt;">This jar file must be in your CLASSPATH to use the Network Client driver.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.jar</span></div><div style="margin-left: 72pt + 32pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> database
engine jar file.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbytools.jar</span></div><div style="margin-left: 72pt + 32pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> tools jar
file.</div></div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Test the CLASSPATH settings by running the following Java command:</span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"> java org.apache.derby.tools.sysinfo</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This command shows the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> jar
files that are in the classpath as well as their respective versions.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>4. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">After you set up your environment correctly, run the NsSample program
from the same directory: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java nserverdemo.NsSample</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the program runs successfully, you will receive output similar
to that shown in the following table:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server created
Server is ready to accept connections on port 1621.
Connection number: 1.
[NsSample] <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server started.
[NsSample] Sample <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server program demo starting.
Please wait .....................
Connection number: 2.
[NsSampleWork] Begin creating table - SAMPLETBL and necessary indexes.
[NsSampleClientThread] Thread id - 1; started.
[NsSampleWork] Thread id - 1; requests database connection, 
	dbUrl =jdbc:derby:NSSampledb;
[NsSampleClientThread] Thread id - 2; started.
[NsSampleWork] Thread id - 2; requests database connection, 
	dbUrl =jdbc:derby://localhost:1621/
	NSSampledb;deferPrepares=true;
Connection number: 3.
[NsSampleWork] Thread id - 1 selected 1 row [313,Derby36   ,1.7686243E23,9620]
[NsSampleWork] Thread id - 1 selected 1 row [313,Derby36   ,1.7686243E23,9620]
[NsSampleWork] Thread id - 1; deleted 1 row with t_key = 9620
[NsSampleWork] Thread id - 1 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 1 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 2 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 2 selected 1 row [700,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 1; inserted 1 row.
[NsSampleWork] Thread id - 1 selected 1 row [52,Derby34   ,8.7620301E9,9547]
[NsSampleWork] Thread id - 2; updated 1 row with t_key = 9547
[NsSampleWork] Thread id - 1; deleted 1 row with t_key = 9547
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 2 selected 1 row [617,Derby31   ,773.83636,9321]
[NsSampleWork] Thread id - 1; inserted 1 row.
[NsSampleWork] Thread id - 2; deleted 1 row with t_key = 9321
[NsSampleWork] Thread id - 1; deleted 1 row with t_key = 8707
[NsSampleWork] Thread id - 1; closed connection to the database.
[NsSampleClientThread] Thread id - 1; finished all tasks.
[NsSampleWork] Thread id - 2; deleted 1 row with t_key = 8490
[NsSampleWork] Thread id - 2; closed connection to the database.
[NsSampleClientThread] Thread id - 2; finished all tasks.
[NsSample] Shutting down Network Server.
Connection number: 4.
Shutdown successful.
</div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N14FA2"></a><span></span>Running the <span style="font-style: italic;">NsSample</span> program also creates the following new
directories and files:<div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NSSampledb</span></div><div style="margin-left: 72pt + 16pt;">This directory makes up the <span style="font-style: italic;">NSSampledb</span> database.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.log </span></div><div style="margin-left: 72pt + 16pt;">This log file contains <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> progress
and error messages.</div></div></div></div></div></div></div><div><a name="N14FF6"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminovntsrvsample"></a><span></span>Network Server sample programs for embedded and client connections</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">This <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server sample program demonstrates how to obtain an embedded connection and
client connections to the same database by using the Network Server. This
program shows how to use either the DriverManager or a DataSource to obtain
client connections.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a database to be consistent, only one JVM can access it at a time.
The embedded driver is loaded when the Network Server is started. The JVM
that starts the Network Server can obtain an embedded connection to the same
database that the Network Server is accessing to serve clients from other
JVMs. This solution provides the performance benefits of the embedded driver
and also allows client connections from other JVMs to connect to the same
database.</div></div><div><a name="N15088"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminovsrvsmpprgm"></a><span></span>Overview of the SimpleNetworkServerSample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The SimpleNetworkServerSample program starts the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server, as well as the embedded driver, and waits for clients to connect. The
program performs the following tasks.
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Starts the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server by using a property and also loads the embedded driver</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Determines if the Network Server is running</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Creates the NSSimpleDB database if it is not already
created</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Obtains an embedded database connection </div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Tests the database connection by executing a sample query</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Allows client connections to connect to the server until you decide to
stop the server and exit the program</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Closes the connection</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Shuts down the Network Server before exiting the program</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"> To run the sample program, install the following files in
the <span style="font-family: Courier;">%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo\</span> directory:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The source file: <span style="font-family: Courier;">SimpleNetworkServerSample.java</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The compiled class file: <span style="font-family: Courier;">SimpleNetworkServerSample.class</span></div></td></tr></table></div></div></div></div><div><a name="N1514C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminovrunsrvprgm"></a><span></span>Running the SimpleNetworkServerSample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15155"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To run the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network
Server sample program: </div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Open a command prompt and change directories to the %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo
directory, where %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%
is the directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the classpath to include the current directory ("."), and the
following jar files: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbynet.jar</span></div><div style="margin-left: 72pt + 32pt;">The Network Server jar file. It must be in your CLASSPATH because you
start the Network Server in this program.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.jar</span></div><div style="margin-left: 72pt + 32pt;">The database engine jar file.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derbytools.jar</span></div><div style="margin-left: 72pt + 32pt;">The <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> tools jar
file.</div></div></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Test the CLASSPATH settings by running the following Java command:
 </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java org.apache.derby.tools.sysinfo</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This command displays the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> jar
files that are in the classpath.</div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>4. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">After you set up your environment correctly, run the SimpleNetworkServerSample
program from the same directory:  </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java SimpleNetworkServerSample</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the program runs successfully, you will receive output that
is similar to that shown in the following exampleS: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Starting Network Server
Testing if Network Server is up and running!
<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server now running
Got an embedded connection.
Testing embedded connection by executing a sample query
number of rows in sys.systables = 16
While my app is busy with embedded work, ij might connect like this:

        $ java -Dij.user=me -Dij.password=pw -Dij.protocol=
			jdbc:derby:\\localhost:1527\ org.apache.derby.tools.ij
        ij&gt; connect 'NSSimpleDB';

Clients can continue to connect:
Press [Enter] to stop Server</div></pre></div></div></td></tr></table></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15206"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">Running the SimpleNetworkServerSample program also creates the
following new directories and files:  <div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">NSSimpleDB</span></div><div style="margin-left: 72pt + 16pt;">This directory makes up the NSSimpleDB database.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">derby.log</span></div><div style="margin-left: 72pt + 16pt;">This log file contains <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> progress
and error messages.</div></div></div></div></div></div></div><div><a name="N15279"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminovcliconnect"></a><span></span>Connecting a client to the Network Server with the SimpleNetworkClientSample
program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The SimpleNetworkClientSample program is a client
program that interacts with the <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> Network Server from another JVM.
The program performs the following tasks:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Loads the network client driver. (Note that this step is not
necessary if you are running the client on JDK 1.6 or higher. In that
environment, the network client driver loads automatically.)</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Obtains a client connection by using the DriverManager.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Obtains a client connection by using a DataSource.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Tests the database connections by running a sample query.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Closes the connections and then exits the program.</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">You must install the following files in the <span style="font-family: Courier;">%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo\</span> directory before you can run the sample program:
<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The source file: <span style="font-family: Courier;">SimpleNetworkClientSample.java.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The compiled class file: <span style="font-family: Courier;">SimpleNetworkClientSample.class.</span></div></td></tr></table></div></div></div></div><div><a name="N15328"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="tadminovclirun"></a><span></span>Running the SimpleNetworkClientSample program</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15331"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To connect to the Network Server that has been started with the
SimpleNetworkServerSample program: </div></div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div>1. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Open a command prompt and change directories to the%<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%\demo\nserverdemo
directory, where %<span style="border-right-width: 0pt; border-left-width: 0pt;">DERBY_HOME</span>%
is the directory where you installed <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>.</span></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>2. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">Set the classpath to include the following jar files: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The current directory (".")</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>derbyclient.jar</div></td></tr></table></div></div></div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div>3. 
          </div></td><td width="8">&nbsp;</td><td valign="top"><div><span style="border-right-width: 0pt; border-left-width: 0pt;">After you set up your environment correctly, run the SimpleNetworkClientSample
program from the same directory: </span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">java SimpleNetworkClientSample</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the program runs successfully, you will receive output similar
to that shown in the following example: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">Starting Sample client program
Got a client connection via the DriverManager.
connection from datasource; 
Got a client connection via a DataSource.
Testing the connection obtained via DriverManager by executing a sample query
number of rows in sys.systables = 16
Testing the connection obtained via a DataSource by executing a sample query
number of rows in sys.systables = 16
Goodbye!</div></pre></div></div></td></tr></table></div></div></div></div></div></div><div><a name="N153D6"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="cadminparttwo"></a><span></span>Part two: Derby Administration Guide</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section of the guide is divided into several administrative tasks.
</div></div><div><a name="N1543E"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminconsist01"></a><span></span>Checking database consistency</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">If you experience hardware or operating system failure, you can use the SYSCS_UTIL.SYSCS_CHECK_TABLE function to verify that the database is still consistent.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Check consistency only if there are indications that such
a check is needed because a consistency check can take a long time on a large
database.</div></div><div><a name="N154E4"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminconsist30301"></a><span></span>The SYSCS_CHECK_TABLE function</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N154FE"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_CHECK_TABLE() function checks the consistency
of a <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> table. In
particular, the <span style="font-style: italic;">SYSCS_UTIL.SYSCS_CHECK_TABLE</span> function verifies the
following conditions:<div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Base tables are internally consistent</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Base tables and all associated indexes contain the same number of rows</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The values and row locations in each index match those of the base table</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>All BTREE indexes are internally consistent</div></td></tr></table></div>You run this function in an SQL statement, as follows:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1552C"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE(
    <span style="font-style: italic;">SchemaName</span>, <span style="font-style: italic;">TableName</span>)</div></pre>where <span style="font-style: italic;">SchemaName</span> and <span style="font-style: italic;">TableName</span> are
expressions that evaluate to a string data type. If you created a schema or
table name as a non-delimited identifier, you must present their names in
all upper case. For example:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'CITIES')</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15555"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_CHECK_TABLE function returns a smallint.
If the table is consistent (or if you run SYSCS_UTIL.SYSCS_CHECK_TABLE on
a view), SYSCS_UTIL.SYSCS_CHECK_TABLE returns a non-zero value. Otherwise,
the function throws an exception on the first inconsistency that it finds.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1555E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a consistent table, the following result is displayed:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15567"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">1
-----
1

1 row selected</div></pre></div></div></div><div><a name="N155A8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminconsist38781"></a><span></span>Sample SYSCS_CHECK_TABLE error messages</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">This section provides examples of error messages that the SYSCS_UTIL.SYSCS_CHECK_TABLE()
function can return.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155C7"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the row counts of the base table and an index differ, error
message X0Y55 is issued:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155D0"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR X0Y55: The number of rows in the base table does not match 
the number of rows in at least 1 of the indexes on the table. Index 
'T1_I' on table 'APP.T1' has 4 rows, but the base table has 5 rows. 
The suggested corrective action is to recreate the index.</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155DA"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If the index refers to a row that does not exist in the base table,
error message X0X62 is issued:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155E3"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR X0X62: Inconsistency found between table 'APP.T1' and index
'T1_I'. Error when trying to retrieve row location '(1,6)' from the 
table. The full index key,including the row location, is '{ 1, (1,6) }'.
The suggested corrective action is to recreate the index.</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155ED"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If a key column value differs between the base table and the index,
error message X0X61 is issued:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N155F6"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">ERROR X0X61: The values for column 'C10' in index 'T1_C10' and 
table 'APP.T1' do not match for row location (1,7). The value in the 
index is '2 2   ', while the value in the base table is 'NULL'. The full
index key, including the row location, is '{ 2 2       , (1,7) }'. The 
suggested corrective action is to recreate the index.</div></pre></div></div></div><div><a name="N15637"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminconsist24642"></a><span></span>Sample SYSCS_CHECK_TABLE queries</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15656"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This section provides examples that illustrate how to use the
SYSCS_UTIL.SYSCS_CHECK_TABLE function in queries.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1565F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the consistency of a single table, run a query that is
similar to the one shown in the following example:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15668"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_CHECK_TABLE('APP', 'FLIGHTS')</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15672"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the consistency of all of the tables in a schema, stopping
at the first failure, run a query that is similar to the one shown in the
following example:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1567B"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SELECT tablename, SYSCS_UTIL.SYSCS_CHECK_TABLE(
    'SAMP', tablename)
FROM sys.sysschemas s, sys.systables t
WHERE s.schemaname = 'SAMP' AND s.schemaid = t.schemaid</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15685"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the consistency of an entire database, stopping at the
first failure, run a query that is similar to the one shown in the following
example::</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1568E"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SELECT schemaname, tablename,
SYSCS_UTIL.SYSCS_CHECK_TABLE(schemaname, tablename)
FROM sys.sysschemas s, sys.systables t
WHERE s.schemaid = t.schemaid</div></pre></div></div></div></div><div><a name="N156CF"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminhubbkup98797"></a><span></span>Backing up and restoring databases</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides
a way to back up a database while it is online. You can also restore a full
backup from a specified location.</div></div><div><a name="N1577D"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminbckupdb"></a><span></span>Backing up a database</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The topics in this section describe how to back up a database.</div></div><div><a name="N1580C"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup12677"></a><span></span>Offline backups</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To perform an offline backup of a database, use operating system
commands to copy the database directory. You must shut down the database prior
to performing an offline backup. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, on Windows systems, the following operating system command 
backs up a (closed) database that is named <span style="font-style: italic;">sample</span> and that is located in <span style="font-family: Courier;">d:\mydatabases</span> by
copying it to the directory <span style="font-family: Courier;">c:\mybackups\2005-06-01</span>:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">xcopy d:\mydatabases\sample c:\mybackups\2005-06-01\sample /s /i</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are not using Windows, substitute the appropriate operating
system command for copying a directory and all contents to a new location.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  On Windows systems, do not attempt to update a database while it is being
backed up in this way. Attempting to update a database during an offline
backup will generate a java.io.IOException. Using online backups prevents
this from occurring.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For large systems, shutting down the database might not be convenient.
To back up a database without having to shut it down, you can use an online backup.</div></div></div><div><a name="N1588E"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup63476"></a><span></span>Online backups</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Use online backups to back up a database while it is running.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You can perform online backups by using several types of backup procedures
or by using operating systems commands with the freeze and unfreeze system
procedures.</div></div><div><a name="N15908"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup01"></a><span></span>Using the backup procedure to perform an online backup: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">Use the SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure to perform an
online backup of a database to a specified location.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure takes a string argument
that represents the location in which to back up the database. Typically,
you provide the full path to the backup directory. (Relative paths are interpreted
as relative to the current directory, not to the derby.system.home directory.)</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, to specify a backup location of <span style="font-family: Courier;">c:/mybackups/2005-06-01</span> for
a database that is currently open, use the following statement (forward slashes
are used as path separators in SQL commands):</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">CALL SYSCS_UTIL.SYSCS_BACKUP_DATABASE('c:/mybackups/2005-06-01')</span></div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The <span style="font-style: italic;">SYSCS_UTIL.SYSCS_BACKUP_DATABASE()</span> procedure puts the database
into a state in which it can be safely copied, then copies the entire original
database directory (including data files, online transaction log files, and
jar files) to the specified backup directory. Files that are not within the
original database directory (for example, <span style="font-style: italic;">derby.properties</span>) are <span style="font-style: italic;">not</span> copied.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example shows how to back up a database to a directory with
a name that reflects the current date:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">public static void backUpDatabase(Connection conn)throws SQLException
{
<span style="font-weight: bold;">// Get today's date as a string:</span>
java.text.SimpleDateFormat todaysDate = 
   new java.text.SimpleDateFormat("yyyy-MM-dd");
String backupdirectory = "c:/mybacksup/" +
   todaysDate.format((java.util.Calendar.getInstance()).getTime());

CallableStatement cs = conn.prepareCall("CALL SYSCS_UTIL.SYSCS_BACKUP_DATABASE(?)"); 
cs.setString(1, backupdirectory);
cs.execute(); 
cs.close();
System.out.println("backed up database to "+backupdirectory);
}</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For a database that was backed up on 2005-06-01, the previous commands
copy the current database to a directory of the same name in <span style="font-style: italic;">c:/mybackups/2005-06-01</span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Uncommitted transactions do not appear in the backed-up database.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Do not back up different databases with the same name to the same backup
directory. If a database of the same name already exists in the backup directory,
it is assumed to be an older version and is overwritten.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure will issue an error if there
are any unlogged operations in the same transaction as the backup procedure.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If any unlogged operations are in progress in other transactions in the
system when the backup starts, this procedure will block until those transactions
are complete before performing the backup.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Derby automatically converts unlogged operations to logged mode if they
are started while the backup is in progress (except operations that maintain
application jar files in the database). Procedures to install, replace, and
remove jar files in a database are blocked while the backup is in progress.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you do not want backup to block until unlogged operations in other transactions
are complete, use the SYSCS_UTIL.SYSCS_BACKUP_DATABASE_NOWAIT procedure. 
This procedure issues an error immediately at the start of the backup if there
are any transactions in progress with unlogged operations, instead of waiting
for those transactions to complete.</div></div></div><div><a name="N159C1"></a><div style="font-size: 11pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup75469"></a><span></span>Using operating system commands with the freeze and unfreeze system
procedures to perform an online backup: </div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Typically, these procedures are used to speed up the copy operation involved
in an online backup. In this scenario, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
not perform the copy operation for you. You use the SYSCS_UTIL.SYSCS_FREEZE_DATABASE
procedure to lock the database, and then you explicitly copy the database
directory by using operating system commands. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For example, because the UNIX tar command uses operating system file-copying
routines, and the SYSCS_UTIL.SYSCS_BACKUP_DATABASE procedure uses java I/O
calls with additional internal synchronization that allow updates during the
backup, the tar command might provide faster backups than the SYSCS_UTIL.SYSCS_BACKUP_DATABASE
procedure.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To use operating system commands for online database backups, call the
SYSCS_UTIL.SYSCS_FREEZE_DATABASE system procedure. The SYSCS_UTIL.SYSCS_FREEZE_DATABASE
system procedure puts the database into a state in which it can be safely
copied. After the database has been copied, use the SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE
system procedure to continue working with the database. Only after SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE
has been specified can transactions once again write to the database. Read
operations can proceed while the database is "frozen."</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  To ensure a consistent backup of the database, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> might
block applications that attempt to write to a frozen database until the backup
is completed and the SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE system procedure is
called.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following example demonstrates how the freeze and unfreeze procedures
are used to surround an operating system copy command:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">public static void backUpDatabaseWithFreeze(Connection conn)
	throws SQLException
{
Statement s = conn.createStatement();
s.executeUpdate(
    "CALL SYSCS_UTIL.SYSCS_FREEZE_DATABASE()");
<span style="font-weight: bold;">//copy the database directory during this interval</span>
s.executeUpdate(
    "CALL SYSCS_UTIL.SYSCS_UNFREEZE_DATABASE()");
s.close();
}</div></pre></div></div></div><div><a name="N15A3B"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup67525"></a><span></span>When the log is in a non-default location</div><div style="margin-left: 72pt; font-size: 10pt;"><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Read <span style="color: blue;"><a href="#cadminlog98">Logging on a separate device</a></span> to find out about
the default location of the database log.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you put the database log in a non-default location prior to backing
up the database, be aware of the following requirements:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>If you are using an operating system command to back up the database,
you must explicitly copy the log file as well, as shown in the following example:
  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">xcopy d:\mydatabases\sample c:\mybackups\2005-06-01\sample /s /i
xcopy h:\janet\tourslog\log c:\mybackups\2005-06-01\sample\log /s /i</div></pre></div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you are not using Windows, substitute the appropriate operating system
command for copying a directory and all of its contents to a new location.</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Edit the <span style="font-style: italic;">logDevice</span> entry in <span style="font-style: italic;">service.properties</span> of the database
backup so that it points to the correct location for the log. In the previous
example, the log was moved to the default location for a log, so you can remove
the logDevice entry entirely, or leave the logDevice entry as is and wait
until the database is restored to edit the entry.</div></td></tr></table></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">See <span style="color: blue;"><a href="#cadminlog98">Logging on a separate device</a></span> for information about
putting the log in a non-default location.</div></div></div><div><a name="N15AD4"></a><div style="font-size: 9pt; font-weight: bold; margin-left: 72pt;"><a name="cadminhubbkup21105"></a><span></span>Backing up encrypted databases</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">When you back up an encrypted database, both the backup and the log files
remain encrypted.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To restore an encrypted database, you must know the boot password.</div></div></div></div><div><a name="N15B4B"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminhubbkup44"></a><span></span>Restoring a database from a backup copy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To restore a database by using a full backup from a specified location,
specify the <span style="font-family: Courier;">restoreFrom=<span style="font-style: italic;">Path</span></span> attribute in the boot
time connection URL.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15B64"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If a database with the same name exists in the derby.system.home
location, the system will delete the database, copy it from the backup location,
and then restart it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The log files are copied to the same location they
were in when the backup was taken. You can use the <span style="font-family: Courier;">logDevice</span> attribute
in conjunction with the <span style="font-family: Courier;">restoreFrom=<span style="font-style: italic;">Path</span></span> attribute
to store logs in a different location.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15B83"></a><span></span> For example, to restore the sample database by using a backup copy
in <span style="font-family: Courier;">c:\mybackups\sample</span>, the connection URL should be: <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:sample;restoreFrom=c:\mybackups\sample</div></pre></div></div></div><div><a name="N15BD8"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadmincrtdbbkup"></a><span></span>Creating a database from a backup copy</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To create a database from a full backup copy at a specified location,
specify the <span style="font-family: Courier;">createFrom=<span style="font-style: italic;">Path</span></span> attribute in the boot
time connection URL.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15C02"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If there is already a database with the same name in derby.system.home,
an error will occur and the existing database will be left intact. If there
is not an existing database with the same name in the current derby.system.home
location, the system will copy the whole database from the backup location
to derby.system.home and start it.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The log files are also copied to
the default location. You can use the <span style="font-family: Courier;">logDevice</span> attribute
in conjunction with the <span style="font-family: Courier;">createFrom=Path</span> attribute to store
logs in a different location. With the <span style="font-family: Courier;">createFrom=Path</span> attribute,
you do not need to copy the individual log files to the log directory.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15C22"></a><span></span>For example, to create the sample database from a backup copy in <span style="font-family: Courier;">c:\mybackups\sample</span>,
the connection URL should be:  <pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:sample;createFrom=c:\mybackups\sample</div></pre></div></div></div><div><a name="N15C77"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminrollforward"></a><span></span>Roll-forward recovery</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> supports
roll-forward recovery to restore a damaged database to the most recent state
before a failure occurred.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> restores a database
from full backup and replays all the transactions after the backup. All the
log files after a backup are required to replay the transactions after the
backup. By default, the database keeps only logs that are required for crash-recovery.
For roll-forward recovery to be successful, all log files must be archived
after a backup. Log files can be archived using the backup function calls
that enable log archiving.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">In roll-forward recovery the log archival mode ensures that all old log
files are available. The log files are available only from the time that the
log archival mode is enabled. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> uses the following
information to restore the database: <div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The backup copy of the database</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The set of archived logs</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>The current online active log</div></td></tr></table></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">You cannot use roll-forward recovery to restore individual tables. Roll-forward
recovery recovers the entire database.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To restore a database by using roll-forward recovery, you must already
have a backup copy of the database, all the archived logs since the backup
was created, and the active log files. All the log files should be in the
database log directory.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">There are two types of log files in <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span>:
active logs and online archived logs.</div><div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Active logs</span></div><div style="margin-left: 72pt + 16pt;">Active logs are used during crash recovery to prevent a failure that might
leave a database in an inconsistent state. Roll-forward recovery can also
use the active logs to recover to the end of the log files. Active logs are
located in the database log path directory.</div></div><div><div style="font-size: 10pt; font-weight: bold; text-indent: 0em; margin-right: 24pt;"><span style="font-weight: bold;">Online archived logs</span></div><div style="margin-left: 72pt + 16pt;">Log files that are stored for roll-forward recovery use when they are
no longer needed for crash recovery. Online archived logs are also kept in
the database log path directory.</div></div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Enabling log archival mode</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Online archive logs are available only if the database is enabled for log
archival mode. You can use the following system procedure to enable the database
for log archival mode:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE
(IN BACKUPDIR VARCHAR(32672), IN SMALLINT DELETE_ARCHIVED_LOG_FILES)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">The input parameters for the calls in the previous example specify the
location where the backup should be stored and specify whether or not the
database should keep online archived logs for the backup. Existing online
archived log files that were created before this backup will be deleted if
the input parameter value for the <span style="font-style: italic;">deleteOnlineArchivedLogFiles</span> parameter
is non-zero. The log files are deleted only after a successful backup. <div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Make
sure to store the backup database in a safe place when you choose the log
file removal option.</div></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE procedure
will issue an error if there are any unlogged operations in the same transaction
as backup procedure.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If any unlogged operations are in progress in other transactions in the
system when the backup starts, this procedure will block until those transactions
are complete before performing the backup. Derby automatically converts unlogged
operations to logged mode if they are started while the backup is in progress
(except operations that maintain application jar files in the database). Procedures
to install, replace, and remove jar files in a database are blocked while
the backup is in progress.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you do not want backup to block until unlogged operations in other transactions
are complete, use the SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE_NOWAIT
procedure. This procedure issues an error immediately at the start of the
backup if there are any transactions in progress with unlogged operations,
instead of waiting for those transactions to complete.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Disabling log archival mode:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After you enable log archival mode, the database will always have the log
archival mode enabled even if it is subsequently booted or backed up. The
only way to disable the log archive mode is to run the following procedure:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">SYSCS_UTIL.SYSCS_DISABLE_LOG_ARCHIVE_MODE(IN SMALLINT DELETE_ARCHIVED_LOG_FILES)</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This system procedure disables the log archive mode and deletes any existing
online archived log files if the input parameter <span style="font-style: italic;">DELETE_ARCHIVED_LOG_FILES</span> is
non-zero.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Performing roll-forward recovery:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By using the full backup copy, archived logs, and active logs, you can
restore a database to its most recent state by performing roll-forward recovery.
You perform a roll-forward recovery by specifying a connection URL attribute <span style="font-style: italic;">rollForwardRecoveryFrom=&lt;BackupPath&gt;</span> at
boot time. This brings the database to its most recent state by using full
backup copy, archived logs, and active logs. All the log files should be in
the database log path directory.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Backing up a database:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">In the following example, a database named wombat is backed up to the d:/backup
directory with log archive mode enabled:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">connect 'jdbc:derby:wombat;create=true';

create table t1(a int not null primary key);
------------------DML/DDL Operations
CALL SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE
('d:/backup', 0);
insert into t1 values(19);
create table t2(a int);
-----------------DML/DDL Operations
-----------------Database Crashed (Media Corruption on data disks)</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-weight: bold;">Restoring a database using roll-forward recovery:</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0em; margin-bottom: 0.6em;">In the following example, the database is restored using roll-forward recovery
after a media failure:<pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">connect 'jdbc:derby:wombat;rollForwardRecoveryFrom=d:/backup/wombat';
select * from t1;
---------------DML/DDL Operations</div></pre></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following attribute can be specified in the JDBC boot time connection
URL:</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="font-style: italic;">rollForwardRecoveryFrom=&lt;Path&gt;</span></div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For more information, see the rollForwardRecoveryFrom=&lt;Path&gt; section
in the <span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">After a database is restored from full backup, transactions from the online
archived logs and active logs are replayed.</div></div></div></div><div><a name="N15E0E"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminlog98"></a><span></span>Logging on a separate device</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">You can improve the performance of update-intensive,
large databases by putting a database's log on a separate device, which
reduces I/O contention.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, the transaction log is in the <span style="font-style: italic;">log</span> subdirectory
of the database directory. Use either of the following methods to store this <span style="font-style: italic;">log</span> subdirectory in another location:</div><div><table width="100%"><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>Specify the non-default location by using the <span style="font-style: italic;">logDevice</span> attribute on the database connection URL when you create the database.</div></td></tr><tr><td valign="top" style="text-align: right;" width="24"><div><span>&bull;</span></div></td><td width="8">&nbsp;</td><td valign="top"><div>If the database is already created, move the log manually and update the <span style="font-style: italic;">service.properties</span> file.</div></td></tr></table></div></div><div><a name="N15EF6"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="tadminlog800206"></a><span></span>Using the logDevice attribute</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">To specify a non-default location for the log directory, set
the logDevice attribute on the database connection URL when
you create the database.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15F1F"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This attribute is meaningful only when you are creating
a database. You can specify <span style="font-family: Courier;">logDevice</span> as either an absolute
path or as a path that is relative to the directory where the JVM is executed.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Setting logDevice on
the database connection URL adds an entry to the service.properties file.
If you ever move the log manually, you will need to alter the entry in service.properties.
If you move the log back to the default location, remove the logDevice entry
from the service.properties file.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15F33"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To check the log location for an existing database, you can retrieve
the <span style="font-family: Courier;">logDevice</span> attribute as a database property by using the
following statement:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">VALUES SYSCS_UTIL.SYSCS_GET_DATABASE_PROPERTY('logDevice')</div></pre></div></div></div><div><a name="N15F8C"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminlog800241"></a><span></span>Example of creating a log in a non-default location</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15F99"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following database connection URL creates a database in the
directory <span style="font-family: Courier;">d:/mydatabases</span>, but puts the database log directory
in <span style="font-family: Courier;">h:/janets/tourslog</span>:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N15FAE"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">jdbc:derby:d:/mydatabases/toursDB;
    create=true;logDevice=h:/janets/tourslog</div></pre></div></div></div><div><a name="N15FFC"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="radminlog800279"></a><span></span>Example of moving a log manually</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16009"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you want to move the log to <span style="font-family: Courier;">g:/bigdisk/tourslog</span>, move the log with operating system commands:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16018"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">move h:\janets\tourslog\log\*.* g:\bigdisk\tourslog\log</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16026"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Then, alter the <span style="font-style: italic;">logDevice </span>entry in <span style="font-style: italic;">service.properties</span> to read as follows:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1603B"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">logDevice=g:/bigdisk/toursLog</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N16045"></a><span></span><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  You can use either a single forward slash or double back slashes
for a path separator.</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1604E"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you later want to move the log back to its default location (in this
case, <span style="font-family: Courier;">d:\mydatabases\toursDB\log</span>), move
the log manually as follows:</div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1605D"></a><span></span><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;"><span style="font-weight: bold;">move g:\bigdisk\tourslog\log\*.* d:\mydatabases\toursDB\log</span></div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1606B"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Then, delete the <span style="font-style: italic;">logDevice </span>entry from <span style="font-style: italic;">service.properties.</span></div></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N1607F"></a><span></span><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  This example uses commands that are specific to the Windows NT operating
system. Use commands appropriate to your operating system to copy a directory
and all of its contents to a new location.</div></div></div></div><div><a name="N160CC"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminlog800315"></a><span></span>Issues for logging in a non-default location</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">When the log is not in the default location, backing up and restoring a
database can require extra steps. See <span style="color: blue;"><a href="#cadminhubbkup98797">Backing up and restoring databases</a></span> for
details.</div></div></div></div><div><a name="N1612A"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminlockvti42553"></a><span></span>Obtaining locking information</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"><span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> provides a tool
to monitor and display locking information. This tool can help you create
applications that minimize deadlock. It can also help you locate the cause
of deadlock when it does occur.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To diagnose locking problems, constantly monitor locking traffic by logging
all deadlocks by using the derby.locks.monitor property.</div></div><div><a name="N161C5"></a><div style="padding-top: 1pc; margin-bottom: 2pt; font-size: 12pt; font-weight: bold;"><a name="cadminlockvti83889"></a><span></span>Monitoring deadlocks</div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">The derby.stream.error.logSeverityLevel property determines the
level of error that you are informed about.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">By default, derby.stream.error.logSeverityLevel is
set to 40000. If derby.stream.error.logSeverityLevel is
set to display transaction-level errors (that is, if it is set to a value
less than 40000), deadlock errors are logged to the derby.log file.
If it is set to a value of 40000 or higher, deadlock errors are not logged
to the derby.log file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The derby.locks.monitor property ensures that deadlock errors are
logged regardless of the value of derby.stream.error.logSeverityLevel.
When derby.locks.monitor is set to true, all
locks that are involved in deadlocks are written to derby.log along with a unique
number that identifies the lock.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">To see a thread's stack trace when a lock is requested, set derby.locks.deadlockTrace to
true. This property is ignored if derby.locks.monitor is
set to false.</div><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  Use derby.locks.deadlockTrace with care. Setting this property
can alter the timing of the application, severely affect performance, and
produce a very large derby.log file.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">For information about how to set properties, and information about the specific properties that are mentioned in this topic, see <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Tuning Derby</span></span></span>.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Here is an example of an error message when <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> aborts
a transaction because of a deadlock:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">--SQLException Caught--

SQLState: 40001 =
Error Code: 30000 
Message: A lock could not be obtained due to a deadlock,
cycle of locks and waiters is: Lock : ROW, DEPARTMENT, (1,14)
Waiting XID : {752, X} , APP, update department set location='Boise'
	where deptno='E21'
Granted XID : {758, X} Lock : ROW, EMPLOYEE, (2,8)
Waiting XID : {758, U} , APP, update employee set bonus=150 where salary=23840
Granted XID : {752, X} The selected victim is XID : 752</div></pre><div><span style="font-weight: bold; border-right-width: 0pt; border-left-width: 0pt;">Note: </span>  You can use the derby.locks.waitTimeout and derby.locks.deadlockTimeout properties
to configure how long <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> waits
for a lock to be released, or when to begin deadlock checking. For more information
about these properties, see the section that discusses controlling <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> application
behavior in the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Developer's Guide</span></span></span>.</div></div></div></div><div><a name="N16262"></a><div style="padding-top: 1pc; margin-bottom: 5pt; font-size: 14pt; font-weight: bold;"><div style="border-right-width: 0pt; border-left-width: 0pt; border-top-width: 1pt; border-top-color: black;"><a name="cadminspace21579"></a><span></span>Reclaiming unused space</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em; margin-left: 72pt;">A <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> table
or index (sometimes called a <span style="font-style: italic;">conglomerate</span>) can contain unused space
after large amounts of data have been deleted or updated.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">This happens because, by default, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
not return unused space to the operating system. After a page has been allocated
to a table or index, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
not automatically return the page to the operating system until the table
or index is dropped, even if the space is no longer needed. However, <span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> does
provide a way to reclaim unused space in tables and associated indexes.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">If you determine that a table and its indexes have a significant amount
of unused space, use either the SYSCS_UTIL.SYSCS_COMPRESS_TABLE or SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE
procedure to reclaim that space. SYSCS_COMPRESS_TABLE is guaranteed to recover
the maximum amount of free space, at the cost of temporarily creating new
tables and indexes before the statement in committed. SYSCS_INPLACE_COMPRESS
attempts to reclaim space within the same table, but cannot guarantee it will
recover all available space. The difference between the two procedures is
that unlike SYSCS_COMPRESS_TABLE, the SYSCS_INPLACE_COMPRESS procedure uses
no temporary files and moves rows around within the same conglomerate.</div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N162A9"></a><span></span><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">As an example, after you have determined that the FlightAvailability
table and its related indexes have too much unused space, you could reclaim
that space with the following command:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">call SYSCS_UTIL.SYSCS_COMPRESS_TABLE('APP', 'FLIGHTAVAILABILITY', 0);</div></pre><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;"> The
third parameter in the SYSCS_UTIL.SYSCS_COMPRESS_TABLE() procedure determines
whether the operation will run in sequential or non-sequential mode. If you
specify <span style="font-family: Courier;">0</span> for the third argument in the procedure, the operation
will run in non-sequential mode. In sequential mode,<span style="border-right-width: 0pt; border-left-width: 0pt;">Derby</span> compresses
the table and indexes sequentially, one at a time. Sequential compression
uses less memory and disk space but is slower. To force the operation to run
in sequential mode, substitute a non-zero smallint value for the third argument.
The following example shows how to force the procedure to run in sequential
mode:</div><pre><div style="margin-top: 1.2em; margin-bottom: 0.8em; background-color: #f0f0f0; font-family: Courier; line-height: 106%; font-size: 9pt;">call SYSCS_UTIL.SYSCS_COMPRESS_TABLE('APP', 'FLIGHTAVAILABILITY', 1);</div></pre></div><div style="line-height: 12pt; margin-top: 0.6em; font-size: 10pt;"><a name="N162CF"></a><span></span>For more information about this command, see the <span style="font-style: italic;"><span style="border-right-width: 0pt; border-left-width: 0pt;"><span style="font-style: italic;">Derby Reference Manual</span></span></span>.</div></div></div></div><div><a name="N16333"></a><div style="margin-top: 0pc; margin-bottom: 1.4pc; font-size: 16pt; font-weight: bold; padding-top: 1.4pc;"><div style="border-right-width: 0pt; border-left-width: 0pt; line-height: 100%; border-top-width: 3pt; border-top-color: black;"><a name="radmintrademderby"></a><span></span>Trademarks</div></div><div style="margin-left: 72pt; font-size: 10pt;"><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">The following terms are trademarks or registered trademarks of other companies
and have been used in at least one of the documents in the <span style="border-right-width: 0pt; border-left-width: 0pt;">Apache Derby</span> documentation
library:</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Cloudscape, DB2, DB2 Universal Database, DRDA, and IBM are trademarks of
International Business Machines Corporation in the United States, other countries,
or both.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Microsoft, Windows, Windows NT, and the Windows logo are trademarks of
Microsoft Corporation in the United States, other countries, or both. </div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Java and all Java-based trademarks are trademarks of Sun Microsystems,
Inc. in the United States, other countries, or both.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">UNIX is a registered trademark of The Open Group in the United States and
other countries.</div><div style="font-size: 10pt; text-indent: 0em; margin-top: 0.6em; margin-bottom: 0.6em;">Other company, product, or service names may be trademarks or service marks
of others.</div></div></div></div></div><div valign="top"><div style="font-family: Helvetica; font-weight: bold; font-size: 10pt; text-align: center;"><span>&bull;</span></div></div><br></body></html>