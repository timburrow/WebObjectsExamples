<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="pt-br" xml:lang="pt-br">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta content="public" name="security" />
<meta content="index,follow" name="Robots" />
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta content="reference" name="DC.Type" />
<meta name="DC.Title" content="especifica????o-de-coluna-gerada" />
<meta content="Atributos da coluna de identidade, especifica????o-de-coluna-gerada" name="DC.subject" />
<meta content="Atributos da coluna de identidade, especifica????o-de-coluna-gerada" name="keywords" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj24513.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj30540.html" />
<meta content="XHTML" name="DC.Format" />
<meta content="rrefsqlj37836" name="DC.Identifier" />
<meta content="pt-br" name="DC.Language" />
<link href="/export/home/rh161140/derby/docs/10.2/out/pt_BR/reftemp/commonltr.css" type="text/css" rel="stylesheet" />
<title>especifica????o-de-coluna-gerada</title>
</head>
<body id="rrefsqlj37836"><a name="rrefsqlj37836"><!-- --></a>


<h1 class="topictitle1">especifica????o-de-coluna-gerada</h1>


<div>
<div class="example">
<pre><strong>[ GENERATED { ALWAYS | BY DEFAULT } AS IDENTITY
[ ( START WITH ConstanteInteira
[ ,INCREMENT BY ConstanteInteira] ) ]  ]  ]
</strong>
</pre>

</div>

<div class="section" id="rrefsqlj37836__sqlj69411"><a name="rrefsqlj37836__sqlj69411"><!-- --></a><h4 class="sectiontitle">Atributos da coluna de identidade</h4>

<p>Nas colunas SMALLINT, INT e BIGINT com atributo de identidade, o
<span>Derby</span>
atribui automaticamente valores inteiros incrementados para a coluna.
Os atributos da coluna de identidade se comportam como os outros valores padr??o,
ou seja, quando a instru????o de inser????o n??o especifica o valor para a coluna, o
<span>Derby</span>
fornece automaticamente o valor.
Entretanto, o valor n??o ?? uma constante; o
<span>Derby</span>
incrementa automaticamente o valor padr??o na hora da inser????o.</p>

<div class="p">A palavra chave IDENTITY somente pode ser especificada quando o tipo de dado
associado ?? coluna for um dos seguintes tipos inteiros exatos.
<ul>
<li>SMALLINT</li>

<li>INT</li>

<li>BIGINT</li>

</ul>

</div>

<div class="p">Existem dois tipos de coluna de identidade no
<span>Derby</span>:
aquelas que s??o sempre geradas (GENERATED ALWAYS), e aquelas que s??o geradas por
padr??o (GENERATED BY DEFAULT).
<dl>

<dt class="dlterm">GENERATED ALWAYS</dt>

<dd>Uma coluna de identidade que ?? sempre gerada, incrementa o valor padr??o
em todas as inser????es e armazena o valor incrementado na coluna.
Ao contr??rio dos outros valores padr??o, n??o ?? poss??vel inserir diretamente um
valor ou atualizar uma coluna de identidade que ?? sempre gerada.
Por isso, deve ser especificada a palavra chave DEFAULT ao fazer inser????o
na coluna de identidade, ou n??o incluir a coluna de identidade na lista
de colunas na inser????o.
Por exemplo:
<pre>CREATE TABLE SAUDA????ES (
    I  INT GENERATED ALWAYS AS IDENTITY,
    CH CHAR(50));
INSERT INTO SAUDA????ES VALUES (DEFAULT, 'al??');
INSERT INTO SAUDA????ES(CH) VALUES ('bom dia');</pre>

Os valores gerados automaticamente na coluna de identidade GENERATED ALWAYS
s??o ??nicos.
A cria????o de uma coluna de identidade n??o cria um ??ndice para a coluna.
</dd>



<dt class="dlterm">GENERATED BY DEFAULT</dt>

<dd><p>Uma coluna de identidade gerada por padr??o, somente incrementa e
utiliza o valor padr??o nas inser????es quando n??o ?? fornecido nenhum valor
expl??cito.
Ao contr??rio da colunas sempre geradas, pode ser especificado um valor na
instru????o de inser????o a ser utilizado no lugar do valor padr??o gerado.</p>

<div class="p">Para utilizar o valor gerado, deve ser especificada a palavra chave
DEFAULT ao inserir na coluna de identidade, ou n??o incluir a
coluna de identidade na lista de colunas da inser????o.
Para especificar um valor, este deve ser inclu??do na instru????o de inser????o.
Por exemplo:
<pre>CREATE TABLE SAUDA????ES (
    I  INT GENERATED BY DEFAULT AS IDENTITY,
    CH CHAR(50));
<strong>-- especificar o valor "1":</strong>
INSERT INTO SAUDA????ES VALUES (1, 'ol??');
<strong>-- usar o padr??o gerado</strong>
INSERT INTO SAUDA????ES VALUES (DEFAULT, 'salut');
<strong>-- usar o padr??o gerado</strong>
INSERT INTO SAUDA????ES(CH) VALUES ('bonjour'); </pre>

Deve ser observado que ao contr??rio das colunas GENERATED ALWAYS, as colunas
GENERATED BY DEFAULT n??o garantem unicidade.
Portanto, no exemplo acima as linhas <samp class="codeph">ol??</samp> e
<samp class="codeph">salut</samp> possuem o valor de identidade igual a "1", porque a
coluna gerada come??a por "1" e o valor especificado pelo usu??rio tamb??m ?? "1".
Para n??o permitir duplicidade, especialmente ao carregar ou importar dados, a
tabela deve ser criada utilizando um valor para START WITH correspondente ao
primeiro valor de identidade que o sistema deve atribuir.
Para verificar esta condi????o e n??o permiti-la, pode ser utilizada uma chave
prim??ria ou restri????o de unicidade na coluna de identidade GENERATED BY DEFAULT.
</div>

</dd>


</dl>

</div>

<p>Por padr??o, o valor inicial da coluna de identidade ?? 1, e o valor do
incremento ?? 1.
Podem ser especificados valores diferentes do padr??o para o valor inicial e
para o incremento ao definir a coluna utilizando as palavras chave
STARTS WITH e INCREMENT BY.
Se for especificado um n??mero negativo para o valor do incremento, o
<span>Derby</span>
<em>decrementar??</em> o valor a cada inser????o.
Se o valor for 0, ou positivo, o
<span>Derby</span>
incrementar?? o valor a cada inser????o.</p>

<div class="p">Os valores m??ximos e m??nimos permitidos nas colunas de identidade s??o
determinados pelo tipo de dado da coluna.
A tentativa de inserir um valor fora da faixa de valores suportados pelo tipo
de dado lan??a uma exce????o.

<div class="tablenoborder"><table summary="" cellspacing="0" cellpadding="4" frame="border" border="1" rules="all"><caption>Tabela 1. Valores m??ximos e m??nimos para colunas com especifica????o de coluna gerada</caption>



<thead align="left">
<tr>
<th align="left" valign="bottom" width="16%" id="N1014A">Tipo de dado</th>

<th align="left" valign="bottom" width="42%" id="N10153">Valor m??ximo</th>

<th align="left" valign="bottom" width="42%" id="N1015C">Valor m??nimo</th>

</tr>

</thead>

<tbody>
<tr>
<td valign="top" width="16%" headers="N1014A ">SMALLINT</td>

<td valign="top" width="42%" headers="N10153 ">32.767 (<em>java.lang.Short.MAX_VALUE</em>)</td>

<td valign="top" width="42%" headers="N1015C ">-32.768 (<em>java.lang.Short.MIN_VALUE</em>)</td>

</tr>

<tr>
<td valign="top" width="16%" headers="N1014A ">INT</td>

<td valign="top" width="42%" headers="N10153 ">2.147.483.647 (<em>java.lang.Integer.MAX_VALUE</em>)</td>

<td valign="top" width="42%" headers="N1015C ">-2.147.483.648 (<em>java.lang.Integer.MIN_VALUE</em>)</td>

</tr>

<tr>
<td valign="top" width="16%" headers="N1014A ">BIGINT</td>

<td valign="top" width="42%" headers="N10153 ">9.223.372.036.854.775.807 (<em>java.lang.Long.MAX_VALUE</em>)</td>

<td valign="top" width="42%" headers="N1015C ">-9.223.372.036.854.775.808 (<em>java.lang.Long.MIN_VALUE</em>)</td>

</tr>

</tbody>

</table>
</div>

</div>

<p>Os valores gerados automaticamente na coluna de identidade s??o ??nicos.
Deve ser utilizada uma restri????o de chave prim??ria ou de unicidade para
garantir a unicidade.
A cria????o da coluna de identidade <em>n??o</em> cria um ??ndice para a coluna.</p>

<p>A fun????o <samp class="codeph">IDENTITY_VAL_LOCAL</samp> ?? uma fun????o n??o determin??stica
que retorna o valor atribu??do mais recentemente a uma coluna de identidade.
Consulte <a href="rrefidentityvallocal.html#rrefidentityvallocal">IDENTITY_VAL_LOCAL</a>
para obter mais informa????es.</p>

<div class="note"><span class="notetitle">Nota: </span>Deve ser especificado o nome do esquema, da tabela e da coluna
utilizando letras mai??sculas e min??sculas conforme os nomes estejam armazenados
nas tabelas do sistema -- ou seja, todas as letras em mai??sculo, a menos que
tenham sido utilizados identificadores delimitados para criar estes objetos
no banco de dados.</div>

<p>O <span>Derby</span>
mant??m o ??ltimo valor incrementado para a coluna no cache.
Tamb??m armazena o pr??ximo valor incrementado para a coluna no disco na
coluna <em>AUTOINCREMENTVALUE</em> da tabela do sistema <em>SYS.SYSCOLUMNS</em>.
Desfazer a transa????o n??o desfaz este valor, portanto transa????es desfeitas
podem deixar "espa??os" nos valores inseridos automaticamente na coluna de
identidade.
O <span>Derby</span>
se comporta desta maneira para evitar bloqueio na linha de <em>SYS.SYSCOLUMNS</em>
pela dura????o da transa????o, e para manter a simultaneidade alta.
</p>

<p>

Quando acontece uma inser????o em uma instru????o-SQL-engatilhada, o valor
inserido pela instru????o-SQL-engatilhada na coluna de identidade ?? dispon??vel
a partir de <em>ConnectionInfo</em> somente dentro do c??digo do gatilho.
O c??digo do gatilho tamb??m pode ver o valor inserido pela instru????o que fez
o gatilho disparar.
Entretanto, a instru????o que fez o gatilho disparar n??o pode ver o valor
inserido pela instru????o-SQL-engatilhada na coluna de identidade.
Da mesma maneira, os gatilhos podem ser aninhados (ou recursivos).
Uma instru????o SQL pode fazer o gatilho T1 disparar.
T1, por sua vez, executa uma instru????o SQL que faz o gatilho T2 disparar.
Se tanto T1 quanto T2 inserem linhas em uma tabela que faz o
<span>Derby</span>
inserir em uma coluna de identidade, o gatilho T1 n??o poder?? ver o valor
produzido pela inser????o feita por T2, mas T2 poder?? ver o valor produzido pela
inser????o feita por T1.
Cada n??vel de aninhamento pode ver os valores incrementados gerados por si
pr??prio e pelos n??veis de aninhamento anteriores, por todo o percurso at?? a
instru????o SQL de n??vel superior que deu in??cio aos gatilhos recursivos.
Somente podem existir 16 n??veis de recursividade de gatilho.</p>

</div>

<div class="section"><h4 class="sectiontitle">Exemplo</h4>

<pre>CREATE TABLE SAUDA????ES (
    I INT GENERATED BY DEFAULT AS IDENTITY (START WITH 2, INCREMENT BY 1),
    CH CHAR(50));
-- especificar o valor  "1":
INSERT INTO SAUDA????ES VALUES (1, 'ol??');
-- usar o valor gerado
INSERT INTO SAUDA????ES VALUES (DEFAULT, 'salut');
-- usar o valor gerado
INSERT INTO SAUDA????ES(CH) VALUES ('bonjour'); </pre>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>T??pico pai:</strong> <a href="rrefsqlj24513.html" title="">Instru????o CREATE TABLE</a></div>
</div>
<div class="relref"><strong>Refer??ncias relacionadas</strong><br />
<div><a href="rrefsqlj30540.html" title="">defini????o-da-coluna</a></div>
</div>
</div>

</body>
</html>